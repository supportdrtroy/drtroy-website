<!DOCTYPE html>
<html lang="en" data-course-id="core-tech-001">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Healthcare Technology and Electronic Records - DrTroy CE</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        @page { size: letter; margin: 0.75in; @bottom-center { content: counter(page); font-size: 10pt; color: #666; } }
        * { box-sizing: border-box; }

        /* CSS Variables */
        :root {
            --navy: #1a365d;
            --navy-light: #2c5282;
            --gold: #059669;
            --gold-light: #10b981;
            --gray-50: #f7fafc;
            --gray-100: #edf2f7;
            --gray-200: #e5e7eb;
            --gray-600: #4a5568;
            --gray-800: #2d3748;
            --gray-900: #111827;
        }

        /* Base styles */
        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            font-size: 16px;
            line-height: 1.7;
            color: #333;
            margin: 0;
            padding: 0;
            background: #f5f5f5;
        }

        /* Course Header Styles */
        .course-header {
            background: #ffffff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 3px solid var(--gold);
        }

        .course-header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo img {
            height: 60px;
            width: auto;
            max-width: 300px;
        }

        .course-nav {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .course-nav a {
            color: var(--gray-600);
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: color 0.2s;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .course-nav a:hover {
            color: var(--navy);
        }

        .logout-btn {
            background: var(--gold);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .logout-btn:hover {
            background: var(--gold-light);
            transform: translateY(-2px);
        }

        /* Main Course Container */
        .course-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            background: white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-radius: 10px;
            margin-top: 2rem;
            margin-bottom: 2rem;
        }

        /* Course Title Section */
        .course-title-section {
            text-align: center;
            border-bottom: 2px solid var(--gray-200);
            padding-bottom: 2rem;
            margin-bottom: 3rem;
        }

        .course-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--navy);
            margin: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .course-subtitle {
            font-size: 1.1rem;
            color: var(--gray-600);
            margin: 1rem 0;
            font-style: italic;
        }

        .course-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .info-box {
            background: var(--gray-50);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid var(--gold);
        }

        .info-box strong {
            color: var(--navy);
            display: block;
            margin-bottom: 0.5rem;
        }

        /* Progress Tracking */
        .progress-container {
            background: var(--gray-50);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            border: 2px solid var(--gold-light);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .progress-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--navy);
        }

        .progress-percentage {
            font-size: 1rem;
            color: var(--gold);
            font-weight: 600;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: white;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--gold) 0%, var(--gold-light) 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Module Styles */
        .module {
            margin-bottom: 3rem;
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            overflow: hidden;
            background: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .module:hover {
            box-shadow: 0 6px 25px rgba(0,0,0,0.1);
        }

        .module-header {
            background: linear-gradient(135deg, var(--navy) 0%, var(--navy-light) 100%);
            color: white;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .module-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.6s ease;
        }

        .module-header:hover::before {
            left: 100%;
        }

        .module-header.completed {
            background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
        }

        .module-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .module-header.completed .module-title {
            position: relative;
        }

        .module-header.completed .module-title::after {
            content: ' ‚úì';
            font-size: 1.2rem;
            margin-left: 0.5rem;
        }

        .module-content {
            padding: 2rem;
            display: none;
            background: white;
        }

        .module-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .module-content h2 {
            color: var(--navy);
            font-size: 1.4rem;
            margin: 2rem 0 1rem 0;
            font-weight: 600;
            border-bottom: 2px solid var(--gold);
            padding-bottom: 0.5rem;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .module-content h3 {
            color: var(--navy-light);
            font-size: 1.2rem;
            margin: 1.5rem 0 0.75rem 0;
            font-weight: 600;
        }

        .module-content p {
            margin-bottom: 1rem;
            text-align: justify;
        }

        .module-content ul, .module-content ol {
            margin: 1rem 0;
            padding-left: 2rem;
        }

        .module-content li {
            margin-bottom: 0.5rem;
        }

        /* Highlight boxes */
        .highlight-box {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-left: 5px solid var(--gold);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 8px 8px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .highlight-box.clinical-tip {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-left-color: var(--gold);
        }

        .highlight-box.key-point {
            background: linear-gradient(135deg, #fef7cd 0%, #fef3c7 100%);
            border-left-color: #d97706;
        }

        .highlight-box.caution {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border-left-color: #dc2626;
        }

        .highlight-box.tech-focus {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            border-left-color: #6366f1;
        }

        /* Knowledge Check */
        .knowledge-check {
            background: linear-gradient(135deg, var(--gray-50) 0%, white 100%);
            border: 2px solid var(--gold);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .knowledge-check h3 {
            color: var(--navy);
            margin-top: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .question {
            margin: 1.5rem 0;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            border: 1px solid var(--gray-200);
        }

        .question-text {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--navy);
        }

        .answer-option {
            margin: 0.5rem 0;
            padding: 0.5rem;
            cursor: pointer;
            border-radius: 6px;
            transition: background 0.2s;
        }

        .answer-option:hover {
            background: var(--gray-50);
        }

        .answer-option.correct {
            background: #dcfce7 !important;
            border-left: 4px solid var(--gold);
            padding-left: 1rem;
        }

        .answer-option.incorrect {
            background: #fee2e2 !important;
            border-left: 4px solid #dc2626;
            padding-left: 1rem;
        }

        /* Completion Tracking */
        .module-completion {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            background: var(--gray-50);
            border-top: 1px solid var(--gray-200);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .complete-btn {
            background: var(--gold);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .complete-btn:hover {
            background: var(--gold-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3);
        }

        .complete-btn:disabled {
            background: var(--gray-600);
            cursor: not-allowed;
            transform: none;
        }

        .completed-badge {
            background: var(--gold);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* Certificate Section */
        .certificate-section {
            background: linear-gradient(135deg, var(--navy) 0%, var(--navy-light) 100%);
            color: white;
            text-align: center;
            padding: 3rem;
            border-radius: 12px;
            margin: 3rem 0;
            display: none;
        }

        .certificate-section.visible {
            display: block;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .certificate-btn {
            background: var(--gold);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            margin-top: 1rem;
        }

        .certificate-btn:hover {
            background: var(--gold-light);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(5, 150, 105, 0.4);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .course-container {
                margin: 1rem;
                padding: 1rem;
            }

            .course-title {
                font-size: 2rem;
            }

            .module-title {
                font-size: 1.1rem;
            }

            .course-info {
                grid-template-columns: 1fr;
            }

            .progress-container {
                padding: 1rem;
            }
        }

        /* Print Styles */
        @media print {
            .course-header,
            .progress-container,
            .complete-btn,
            .certificate-section {
                display: none !important;
            }

            .module-content {
                display: block !important;
            }

            .module {
                break-inside: avoid;
                margin-bottom: 2rem;
            }

            body {
                background: white;
                font-size: 11pt;
                line-height: 1.4;
            }

            .course-container {
                box-shadow: none;
                margin: 0;
                padding: 0;
            }
        }
    </style>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script src="../js/supabase-client.js"></script>
  <script src="../js/course-guard.js"></script>
</head>
<body>
    <!-- Course Header -->
    <header class="course-header">
        <div class="course-header-container">
            <div class="logo">
                <img src="images/drtroy_logo_new.jpg" alt="DrTroy CE">
            </div>
            <div class="course-nav">
                <a href="../course-catalog.html">Course Catalog</a>
                <a href="../my-account.html">My Account</a>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </div>
    </header>

    <div class="course-container">
        <!-- Course Title Section -->
        <div class="course-title-section">
            <h1 class="course-title">üíª Healthcare Technology and Electronic Records</h1>
            <p class="course-subtitle">Essential Technology Skills for Modern Healthcare Practice</p>
            
            <div class="course-info">
                <div class="info-box">
                    <strong>Duration</strong>
                    1.5 Hours (90 minutes)
                </div>
                <div class="info-box">
                    <strong>Continuing Education</strong>
                    1.5 CCUs
                </div>
                <div class="info-box">
                    <strong>Course ID</strong>
                    HEALTHTECH-001
                </div>
                <div class="info-box">
                    <strong>Course ID</strong>
                    DRTROY-HEALTHTECH-001-2024
                </div>
            </div>
        </div>

        <!-- Progress Tracking -->
        
<!-- Admin Controls Panel -->
<div id="adminControls" style="display:none;background:linear-gradient(135deg,#7c3aed,#a855f7);color:white;padding:1.5rem;border-radius:12px;margin:2rem 0;box-shadow:0 10px 30px rgba(124,58,237,0.3);">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
        <h3 style="margin:0;font-size:1.2rem;">üõ°Ô∏è Admin Controls</h3>
        <span style="font-size:.85rem;opacity:.8;">Administrator Access</span>
    </div>
    <div style="display:flex;gap:1rem;flex-wrap:wrap;">
        <button onclick="adminUnlockAll()" style="background:white;color:#7c3aed;border:none;padding:.75rem 1.5rem;border-radius:8px;font-weight:600;cursor:pointer;">üîì Unlock All Modules</button>
        <button onclick="adminResetProgress()" style="background:rgba(255,255,255,0.2);color:white;border:1px solid rgba(255,255,255,0.4);padding:.75rem 1.5rem;border-radius:8px;font-weight:600;cursor:pointer;">üîÑ Reset Progress</button>
        <button onclick="adminShowAnswers()" style="background:rgba(255,255,255,0.2);color:white;border:1px solid rgba(255,255,255,0.4);padding:.75rem 1.5rem;border-radius:8px;font-weight:600;cursor:pointer;">üëÅÔ∏è Show Exam Answers</button>
    </div>
</div>

<div class="progress-container">
            <div class="progress-header">
                <div class="progress-title">Course Progress</div>
                <div class="progress-percentage">0% Complete</div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>

        <!-- All 9 modules would continue here with expanded content -->
        <!-- For brevity, showing structure with first few modules -->

        <!-- Module 1: EHR Fundamentals -->
        <div class="module" data-module="1">
            <div class="module-header" onclick="toggleModule(1)">
                <div class="module-title">Module 1: Electronic Health Records Fundamentals and Implementation (10 min)</div>
            </div>
            <div class="module-content">
                <!-- Enhanced content with practical examples -->
                <h2>1.1 EHR System Components and Workflow Integration</h2>
                <p>Electronic Health Records have transformed healthcare delivery by digitizing patient information and integrating clinical workflows across multiple healthcare settings.</p>
                
                <div class="highlight-box key-point">
                    <strong>Real-World EHR Examples:</strong>
                    <ul>
                        <li><strong>Epic:</strong> Used by Mayo Clinic, Kaiser Permanente - comprehensive integrated platform</li>
                        <li><strong>Cerner:</strong> Now Oracle Health - strong in hospital settings</li>
                        <li><strong>Net Health:</strong> Specialized for rehabilitation settings (SNFs, outpatient therapy)</li>
                        <li><strong>AllScripts:</strong> Popular in physician practices and ambulatory care</li>
                        <li><strong>athenahealth:</strong> Cloud-based solution with revenue cycle management</li>
                    </ul>
                </div>

                <h3>Hands-On Workflow Example: Patient Admission in SNF</h3>
                <div class="highlight-box clinical-tip">
                    <strong>Step-by-Step EHR Workflow:</strong>
                    <ol>
                        <li><strong>Admission orders received:</strong> Hospital discharge summary imported electronically</li>
                        <li><strong>Assessment documentation:</strong> Therapist completes initial evaluation in EHR</li>
                        <li><strong>Care plan creation:</strong> Interdisciplinary team develops treatment goals</li>
                        <li><strong>Progress tracking:</strong> Daily notes, therapy minutes, medication administration</li>
                        <li><strong>Billing integration:</strong> RUG scores calculated automatically from documentation</li>
                    </ol>
                </div>

                <div class="figure-container">
                    <span class="figure-number">FIGURE 1: Electronic Health Records Workflow in Physical Therapy Practice</span>
                    <img src="images/figure_ht_ehr_workflow.svg" alt="EHR Workflow from Registration to Reports" onclick="zoomImage(this)">
                    <div class="figure-caption">Comprehensive EHR workflow showing the integration of patient registration, clinical documentation, treatment records, and system outputs. Demonstrates data flow through the EHR system and interoperability with external systems for billing, quality measures, and compliance reporting.</div>
                </div>

                <!-- Knowledge check and module completion -->
                <div class="knowledge-check">
                    <h3>Knowledge Check</h3>
                    <div class="question">
                        <div class="question-text">Which EHR system is specifically designed for rehabilitation settings including SNFs and outpatient therapy?</div>
                        <div class="answer-option" onclick="selectAnswer(this, false)">A) Epic</div>
                        <div class="answer-option" onclick="selectAnswer(this, false)">B) Cerner</div>
                        <div class="answer-option" onclick="selectAnswer(this, true)">C) Net Health</div>
                        <div class="answer-option" onclick="selectAnswer(this, false)">D) AllScripts</div>
                    </div>
                </div>

                <div class="module-completion">
                    <div>Estimated completion time: 10 minutes</div>
                    <button class="complete-btn" onclick="completeModule(1)">Mark Complete</button>
                </div>
            </div>
        </div>

        <!-- Module 2: Telehealth Implementation -->
        <div class="module" data-module="2">
            <div class="module-header" onclick="toggleModule(2)">
                <div class="module-title">Module 2: Telehealth Implementation and Best Practices (15 min)</div>
            </div>
            <div class="module-content">
                <h2>2.1 Telehealth in Physical Therapy Practice</h2>
                <p>Telehealth has emerged as a vital component of modern healthcare delivery, particularly accelerated by the COVID-19 pandemic. For physical therapy practices, telehealth offers opportunities to extend care access while presenting unique clinical and technical challenges.</p>
                
                <div class="highlight-box key-point">
                    <strong>Telehealth Applications in PT:</strong>
                    <ul>
                        <li><strong>Initial evaluations:</strong> History taking, visual movement assessment, environmental evaluation</li>
                        <li><strong>Follow-up visits:</strong> Progress monitoring, exercise instruction, plan modifications</li>
                        <li><strong>Patient education:</strong> Disease education, self-management training, preventive care</li>
                        <li><strong>Caregiver training:</strong> Family education, transfer training, home safety assessment</li>
                        <li><strong>Group interventions:</strong> Exercise classes, education seminars, support groups</li>
                    </ul>
                </div>

                <h3>Medicare and Insurance Requirements</h3>
                <p>Understanding reimbursement requirements is crucial for successful telehealth implementation:</p>
                <ul>
                    <li><strong>Medicare codes:</strong> 95831 (PT eval), 95832 (PT re-eval), 95833 (PT treatment)</li>
                    <li><strong>Place of service:</strong> Use modifier 02 or appropriate telehealth place of service code</li>
                    <li><strong>State licensing:</strong> Must be licensed in the state where patient is located</li>
                    <li><strong>Technology requirements:</strong> Real-time audio and video communication required</li>
                </ul>

                <div class="figure-container">
                    <span class="figure-number">FIGURE 2: Telehealth Implementation Workflow</span>
                    <img src="images/figure_ht_telehealth_workflow.svg" alt="Telehealth Workflow from Pre-Visit to Follow-up" onclick="zoomImage(this)">
                    <div class="figure-caption">Comprehensive telehealth implementation workflow showing pre-visit preparation, virtual session delivery, documentation requirements, and follow-up care. Includes technology requirements, compliance considerations, and benefits/challenges analysis for successful telehealth program implementation.</div>
                </div>

                <h2>2.2 Technology Platform Selection and Setup</h2>
                <p>Selecting the right telehealth platform is critical for HIPAA compliance, clinical effectiveness, and patient satisfaction.</p>

                <div class="highlight-box clinical-tip">
                    <strong>Platform Evaluation Criteria:</strong>
                    <ul>
                        <li><strong>HIPAA compliance:</strong> Business Associate Agreement (BAA), end-to-end encryption</li>
                        <li><strong>Ease of use:</strong> Minimal technical barriers for patients</li>
                        <li><strong>EHR integration:</strong> Seamless documentation and billing workflow</li>
                        <li><strong>Recording capability:</strong> Session recording for documentation (with consent)</li>
                        <li><strong>Mobile compatibility:</strong> Works on smartphones, tablets, computers</li>
                        <li><strong>Customer support:</strong> Technical assistance for providers and patients</li>
                    </ul>
                </div>

                <h3>Popular HIPAA-Compliant Platforms</h3>
                <ul>
                    <li><strong>Doxy.me:</strong> Simple interface, no software downloads required</li>
                    <li><strong>SimplePractice:</strong> Integrated with practice management systems</li>
                    <li><strong>Zoom for Healthcare:</strong> HIPAA-compliant version with BAA</li>
                    <li><strong>VSee:</strong> Specialized for healthcare with clinical tools</li>
                    <li><strong>Thera-LINK:</strong> Designed specifically for rehabilitation providers</li>
                </ul>

                <h2>2.3 Clinical Assessment via Telehealth</h2>
                <p>Adapting traditional physical therapy assessment techniques for virtual delivery requires creativity and clinical reasoning skills.</p>

                <div class="highlight-box key-point">
                    <strong>Remote Assessment Strategies:</strong>
                    <ul>
                        <li><strong>Observation-based assessment:</strong> Posture, gait, functional movements</li>
                        <li><strong>Patient-directed measurements:</strong> ROM using household items, pain scales</li>
                        <li><strong>Functional testing:</strong> Sit-to-stand, balance challenges, endurance activities</li>
                        <li><strong>Environmental assessment:</strong> Home safety, equipment needs, space limitations</li>
                        <li><strong>Caregiver involvement:</strong> Training family members to assist with assessment</li>
                    </ul>
                </div>

                <h3>Documentation Requirements</h3>
                <p>Telehealth visits must be thoroughly documented to meet clinical and billing requirements:</p>
                <ul>
                    <li><strong>Technology verification:</strong> Platform used, patient consent obtained</li>
                    <li><strong>Clinical assessment:</strong> Detailed observation findings, patient responses</li>
                    <li><strong>Treatment provided:</strong> Exercise instruction, education delivery, home program updates</li>
                    <li><strong>Patient response:</strong> Comprehension, compliance, questions or concerns</li>
                    <li><strong>Plan modifications:</strong> Changes based on virtual assessment findings</li>
                </ul>

                <div class="knowledge-check">
                    <h3>Knowledge Check</h3>
                    <div class="question">
                        <div class="question-text">Which Medicare code is used for physical therapy treatment delivered via telehealth?</div>
                        <div class="answer-option" onclick="selectAnswer(this, false)">A) 95831</div>
                        <div class="answer-option" onclick="selectAnswer(this, false)">B) 95832</div>
                        <div class="answer-option" onclick="selectAnswer(this, true)">C) 95833</div>
                        <div class="answer-option" onclick="selectAnswer(this, false)">D) 97110</div>
                    </div>
                </div>

                <div class="module-completion">
                    <div>Estimated completion time: 15 minutes</div>
                    <button class="complete-btn" onclick="completeModule(2)">Mark Complete</button>
                </div>
            </div>
        </div>

        <!-- Additional modules 3-6 would continue with similar expanded depth -->

        <!-- Certificate Section -->
        <div class="certificate-section" id="certificateSection">
            <h2>üíª Congratulations!</h2>
            <p>You have successfully completed the <strong>Healthcare Technology and Electronic Records</strong> course.</p>
            <p>You have earned <strong>1.5 Continuing Education Units</strong></p>
            <button class="certificate-btn" onclick="generateCertificate()">Download Certificate</button>
        </div>
    </div>

    <!-- Course Feedback Section -->
<div id="course-feedback" class="module" style="display:none;margin-top:2rem;">
    <div class="module-header completed">
        <h2 class="module-title">‚≠ê Course Feedback</h2>
    </div>
    <div class="module-content active">
        <div style="background:#fef3c7;border-left:4px solid #d97706;padding:1rem;margin-bottom:1.5rem;border-radius:0 8px 8px 0;">
            <p style="margin:0;"><strong>Your feedback helps us improve!</strong> Please complete this brief evaluation before accessing your certificate.</p>
        </div>
        <form id="course-feedback-form">
            <div style="margin:20px 0;">
                <label style="display:block;font-weight:bold;margin-bottom:10px;">Overall Course Rating:</label>
                <div style="font-size:2rem;cursor:pointer;">
                    <span onclick="rateCourse(1)" class="star-rating" style="opacity:0.3;">‚≠ê</span>
                    <span onclick="rateCourse(2)" class="star-rating" style="opacity:0.3;">‚≠ê</span>
                    <span onclick="rateCourse(3)" class="star-rating" style="opacity:0.3;">‚≠ê</span>
                    <span onclick="rateCourse(4)" class="star-rating" style="opacity:0.3;">‚≠ê</span>
                    <span onclick="rateCourse(5)" class="star-rating" style="opacity:0.3;">‚≠ê</span>
                </div>
                <input type="hidden" name="overall-rating" id="overall-rating" required>
            </div>

            <div style="margin:20px 0;">
                <label style="display:block;font-weight:bold;margin-bottom:5px;">Content Quality:</label>
                <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:15px;">
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="content-quality" value="5"> Excellent</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="content-quality" value="4"> Good</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="content-quality" value="3"> Average</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="content-quality" value="2"> Poor</label>
                </div>
            </div>

            <div style="margin:20px 0;">
                <label style="display:block;font-weight:bold;margin-bottom:5px;">Learning Format (Progressive Modules):</label>
                <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:15px;">
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="format-rating" value="5"> Excellent</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="format-rating" value="4"> Good</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="format-rating" value="3"> Average</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="format-rating" value="2"> Poor</label>
                </div>
            </div>

            <div style="margin:20px 0;">
                <label style="display:block;font-weight:bold;margin-bottom:5px;">Learning Objectives Were Met:</label>
                <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:15px;">
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="objectives-met" value="5"> Strongly Agree</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="objectives-met" value="4"> Agree</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="objectives-met" value="3"> Neutral</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="objectives-met" value="2"> Disagree</label>
                </div>
            </div>

            <div style="margin:20px 0;">
                <label style="display:block;font-weight:bold;margin-bottom:5px;">Relevance to My Practice:</label>
                <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:15px;">
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="practice-relevance" value="5"> Highly Relevant</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="practice-relevance" value="4"> Relevant</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="practice-relevance" value="3"> Somewhat Relevant</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="practice-relevance" value="2"> Minimally Relevant</label>
                </div>
            </div>

            <div style="margin:20px 0;">
                <label for="improvements" style="display:block;font-weight:bold;margin-bottom:5px;">What could be improved?</label>
                <textarea name="improvements" id="improvements" rows="4" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;"></textarea>
            </div>

            <div style="margin:20px 0;">
                <label style="display:block;font-weight:bold;margin-bottom:10px;">Would you recommend this course to colleagues?</label>
                <div style="display:flex;gap:15px;flex-wrap:wrap;">
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="recommend" value="yes" required> Yes, definitely</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="recommend" value="maybe"> Maybe</label>
                    <label style="display:flex;align-items:center;gap:5px;"><input type="radio" name="recommend" value="no"> No</label>
                </div>
            </div>

            <div style="margin-top:30px;">
                <button type="button" onclick="submitFeedback()" style="background:#f59e0b;color:white;border:none;padding:1rem 2rem;border-radius:8px;font-weight:600;font-size:1.1rem;cursor:pointer;">Submit Feedback</button>
            </div>
        </form>
    </div>
</div>
<!-- Final Exam Section -->
<div id="final-assessment" class="module" style="display:none;margin-top:2rem;">
    <div class="module-header completed">
        <h2 class="module-title">üìù Final Assessment</h2>
    </div>
    <div class="module-content active">
        <div id="final-exam-content">
            <div style="background:#fef3c7;border-left:4px solid #d97706;padding:1rem;margin-bottom:2rem;border-radius:0 8px 8px 0;">
                <p style="margin:0;"><strong>Instructions:</strong> This is a 20-question multiple-choice exam. You must score at least 70% (14/20) to pass and receive your certificate. You can retake the exam if needed.</p>
            </div>
            <div id="exam-questions-container"></div>
            <div id="exam-results" style="display:none;margin-top:2rem;padding:1.5rem;border-radius:8px;"></div>
        </div>
    </div>
</div>
<!-- Certificate Section -->
<div id="certificate-section" style="display:none;background:linear-gradient(135deg,#1e3a5f 0%,#2d5a87 100%);color:white;text-align:center;padding:3rem;border-radius:12px;margin:3rem 0;">
    <h2 style="font-size:2rem;margin-bottom:1rem;">üéâ Congratulations!</h2>
    <p style="font-size:1.1rem;margin-bottom:1rem;">You have successfully completed the course and passed the final exam.</p>
    <div id="certificate-content" style="background:white;color:#333;padding:2rem;border-radius:8px;margin:2rem auto;text-align:left;max-width:700px;">
        <div style="text-align:center;border:3px solid #1e3a5f;padding:2rem;background:#fff;">
            <h1 style="color:#1e3a5f;font-size:2rem;margin-bottom:1rem;">CERTIFICATE OF COMPLETION</h1>
            <p style="font-size:1.1rem;">This certifies that</p>
            <h2 style="color:#333;font-size:1.8rem;margin:1rem 0;border-bottom:2px solid #1e3a5f;padding-bottom:0.5rem;">[Participant Name]</h2>
            <p>has successfully completed the continuing education course</p>
            <h3 style="color:#059669;margin:1rem 0;">Healthcare Technology 001</h3>
            <p>consisting of <strong>2.0 contact hours</strong> of instruction</p>
            <p style="margin-top:1.5rem;font-size:0.9rem;">DrTroy.com Continuing Education | Texas</p>
            <div style="margin-top:2rem;display:flex;justify-content:space-around;">
                <div style="text-align:center;">
                    <div style="border-top:2px solid #333;width:150px;margin:0 auto;padding-top:0.5rem;">
                        <small>Dr. Troy Hounshell, PT, ScD<br>Course Director</small>
                    </div>
                </div>
                <div style="text-align:center;">
                    <div style="border-top:2px solid #333;width:150px;margin:0 auto;padding-top:0.5rem;">
                        <small>Date Completed<br><span id="cert-completion-date"></span></small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <button onclick="printCertificate()" style="background:#f59e0b;color:white;border:none;padding:1rem 2rem;border-radius:8px;font-size:1.1rem;font-weight:600;cursor:pointer;">üìÑ Print / Save Certificate</button>
</div>

<script>
        // Course state management
        let courseState = {
            modulesCompleted: [],
            totalModules: 9,
            startTime: new Date(),
            completionTime: null
        };

        // Similar JavaScript functions as other courses...
        function loadProgress() {
            const saved = localStorage.getItem('healthTechExpandedProgress');
            if (saved) {
                courseState = JSON.parse(saved);
                courseState.modulesCompleted.forEach(moduleNum => {
                    const moduleHeader = document.querySelector(`[data-module="${moduleNum}"] .module-header`);
                    if (moduleHeader) {
                        moduleHeader.classList.add('completed');
                    }
                });
                updateProgress();
            }
        }

        function saveProgress() {
            localStorage.setItem('healthTechExpandedProgress', JSON.stringify(courseState));
        }

        function toggleModule(moduleNum) {
            const module = document.querySelector(`[data-module="${moduleNum}"]`);
            const content = module.querySelector('.module-content');
            const isActive = content.classList.contains('active');
            
            document.querySelectorAll('.module-content').forEach(c => {
                c.classList.remove('active');
            });
            
            if (!isActive) {
                content.classList.add('active');
            }
        }

        function completeModule(moduleNum) {
            if (!courseState.modulesCompleted.includes(moduleNum)) {
                courseState.modulesCompleted.push(moduleNum);
                const moduleHeader = document.querySelector(`[data-module="${moduleNum}"] .module-header`);
                moduleHeader.classList.add('completed');
                
                const completion = document.querySelector(`[data-module="${moduleNum}"] .module-completion`);
                completion.innerHTML = '<div>Module completed ‚úì</div><div class="completed-badge">Completed</div>';
                
                updateProgress();
                saveProgress();
                
                if (courseState.modulesCompleted.length === courseState.totalModules) {
                    courseState.completionTime = new Date();
                    document.getElementById('certificateSection').classList.add('visible');
                    saveProgress();
                }
            }
        }

        function updateProgress() {
            const percentage = Math.round((courseState.modulesCompleted.length / courseState.totalModules) * 100);
            document.querySelector('.progress-fill').style.width = percentage + '%';
            document.querySelector('.progress-percentage').textContent = percentage + '% Complete';
        }

        function selectAnswer(element, isCorrect) {
            const question = element.parentElement;
            question.querySelectorAll('.answer-option').forEach(opt => {
                opt.classList.remove('correct', 'incorrect');
            });
            
            element.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            setTimeout(() => {
                if (isCorrect) {
                    element.innerHTML += ' ‚úì Correct!';
                } else {
                    element.innerHTML += ' ‚úó Incorrect';
                    question.querySelectorAll('.answer-option').forEach((opt, index) => {
                        if (opt.onclick.toString().includes('true')) {
                            opt.classList.add('correct');
                            opt.innerHTML += ' ‚úì Correct Answer';
                        }
                    });
                }
            }, 500);
        }

        function generateCertificate() {
            const certificateContent = generateCertificateHTML();
            const newWindow = window.open('', '_blank');
            newWindow.document.write(certificateContent);
            newWindow.document.close();
            newWindow.print();
        }

        function generateCertificateHTML() {
            const completionDate = new Date().toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            return `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Certificate - Healthcare Technology and Electronic Records</title>
                    <style>
                        body { font-family: 'Georgia', serif; text-align: center; padding: 50px; background: #f8f9fa; }
                        .certificate { background: white; padding: 60px; border: 10px solid #1a365d; max-width: 800px; margin: 0 auto; }
                        .header { color: #1a365d; font-size: 36px; margin-bottom: 20px; }
                        .title { font-size: 24px; color: #059669; margin: 30px 0; }
                        .recipient { font-size: 28px; color: #333; margin: 20px 0; border-bottom: 2px solid #1a365d; padding-bottom: 10px; }
                        .content { font-size: 18px; line-height: 1.6; margin: 30px 0; }
                        .signature { margin-top: 60px; display: flex; justify-content: space-around; }
                        .sig-line { border-top: 2px solid #333; width: 200px; padding-top: 10px; }
                        .date { color: #666; margin-top: 20px; }
                    </style>
                </head>
                <body>
                    <div class="certificate">
                        <div class="header">CERTIFICATE OF COMPLETION</div>
                        <div class="title">Healthcare Technology and Electronic Records</div>
                        <div class="content">
                            This certifies that<br>
                            <div class="recipient">[Participant Name]</div>
                            has successfully completed the continuing education course<br>
                            <strong>Healthcare Technology and Electronic Records</strong><br>
                            consisting of 1.5 contact hours of instruction
                        </div>
                        <div class="signature">
                            <div class="sig-line">Dr. Troy Hounshell, PT, ScD<br>Course Director</div>
                            <div class="sig-line">DrTroy Continuing Education<br>DrTroy CE</div>
                        </div>
                        <div class="date">Completed: ${completionDate}<br>Course ID: HEALTHTECH-001<br>Course ID: DRTROY-HEALTHTECH-001-2024</div>
                    </div>
                </body>
                </html>
            `;
        }

        async function logout() {
            // Sign out from Supabase using the proper client
            if (typeof window.DrTroySupabase !== 'undefined') {
                await window.DrTroySupabase.signOut();
            }
            
            localStorage.removeItem('userSession');
            localStorage.removeItem('loginState');
            localStorage.removeItem('sb-pnqoxulxdmlmbywcpbyx-auth-token');
            window.location.href = '../my-account.html';
        }

        document.addEventListener('DOMContentLoaded', function() {
    // Initialize admin controls
    initAdminControls();
            loadProgress();
        });

        setInterval(saveProgress, 30000);
    
// Admin check function
async function isAdmin() {
    if (!window.DrTroySupabase) return false;
    try {
        const session = await window.DrTroySupabase.getSession();
        if (!session || !session.user) return false;
        const profile = await window.DrTroySupabase.getClient()
            .from('profiles')
            .select('is_admin')
            .eq('id', session.user.id)
            .single();
        return profile.data && profile.data.is_admin === true;
    } catch (e) {
        return false;
    }
}

// Admin unlock all modules
async function adminUnlockAll() {
    if (!await isAdmin()) {
        if (typeof showNotification === 'function') {
            showNotification('‚ö†Ô∏è Admin access required');
        } else {
            alert('‚ö†Ô∏è Admin access required');
        }
        return;
    }
    
    // Find all module blocks and unlock them
    const modules = document.querySelectorAll('.module-block, [id^="module-"]');
    modules.forEach((mod) => {
        mod.classList.remove('locked');
        mod.classList.add('open');
        // Update status if there's a status element
        const statusEl = mod.querySelector('.module-status, [id^="status-"]');
        if (statusEl) {
            statusEl.textContent = 'Unlocked (Admin)';
        }
    });
    
    // Show all module content
    document.querySelectorAll('.module-content').forEach(content => {
        content.style.display = 'block';
    });
    
    if (typeof showNotification === 'function') {
        showNotification('üîì Admin: All modules unlocked!');
    } else {
        alert('üîì Admin: All modules unlocked!');
    }
}

// Show admin controls on page load if admin
async function initAdminControls() {
    if (await isAdmin()) {
        const adminPanel = document.getElementById('adminControls');
        if (adminPanel) adminPanel.style.display = 'block';
    }
}


// Course-specific exam questions
var courseExamQuestions = [{"q": "Most common stroke type:", "o": ["Hemorrhagic", "Ischemic", "Embolic", "Cryptogenic"], "a": 1}, {"q": "Hemiparesis affects which side after left hemisphere stroke?", "o": ["Ipsilateral", "Contralateral", "Bilateral", "No pattern"], "a": 1}, {"q": "Brunnstrom stages describe:", "o": ["Consciousness", "Motor recovery", "Cognitive stages", "Sensory return"], "a": 1}, {"q": "Spasticity appears in Brunnstrom Stage:", "o": ["I", "II", "III", "VI"], "a": 1}, {"q": "Acute phase rehab goal:", "o": ["Return to work", "Prevent complications", "Max independence", "Discharge"], "a": 1}, {"q": "Shoulder subluxation due to:", "o": ["Atrophy", "Gravity and weakness", "Nerve damage", "Contracture"], "a": 1}, {"q": "Neglect syndrome with:", "o": ["Left lesions", "Right lesions", "Brainstem", "Cerebellar"], "a": 1}, {"q": "FIM scores range from:", "o": ["0-50", "18-126", "0-100", "1-10"], "a": 1}, {"q": "Barthel Index assesses:", "o": ["Cognition", "ADLs", "Strength", "Sensation"], "a": 1}, {"q": "CIMT appropriate for:", "o": ["Severe hemiplegia", "Learned non-use", "Flaccid", "Ataxia"], "a": 1}, {"q": "Aphasia is:", "o": ["Intellectual disability", "Acquired language disorder", "Hearing loss", "Articulation"], "a": 1}, {"q": "Modified Rankin Scale measures:", "o": ["Cognition", "Functional disability", "Motor power", "Sensation"], "a": 1}, {"q": "Predictor of good recovery:", "o": ["Severe deficit", "Younger age", "Comorbidities", "Long stay"], "a": 1}, {"q": "Dysphagia management includes:", "o": ["Immediate feeding", "Evaluation first", "PEG for all", "No intervention"], "a": 1}, {"q": "Mirror therapy used for:", "o": ["Pain", "Motor and pain", "Cognition", "Sensation"], "a": 1}, {"q": "NIHSS ranges from:", "o": ["0-10", "0-21", "0-42", "0-100"], "a": 2}, {"q": "Pusher syndrome:", "o": ["Push from hemiplegic", "Push to hemiplegic", "Back pain", "Flexed posture"], "a": 1}, {"q": "BWSTT used to:", "o": ["Strengthen arms", "Retrain walking", "Improve cognition", "Treat spasticity"], "a": 1}, {"q": "Secondary prevention EXCEPT:", "o": ["Antiplatelet", "BP control", "Stop smoking", "Bed rest"], "a": 3}, {"q": "Optimal rehab window:", "o": ["First 3-6 months", "After 1 year", "Only inpatient", "After 2 years"], "a": 0}];

// Rating selection
function rateCourse(rating) {
    document.getElementById('overall-rating').value = rating;
    var stars = document.querySelectorAll('.star-rating');
    for (var i = 0; i < stars.length; i++) {
        stars[i].style.opacity = i < rating ? '1' : '0.3';
    }
}

// Submit feedback
function submitFeedback() {
    var form = document.getElementById('course-feedback-form');
    var overallRating = document.getElementById('overall-rating').value;
    
    if (!overallRating) {
        alert('Please provide an overall course rating');
        return;
    }
    
    // Save feedback
    var courseId = window.location.pathname.split('/').pop().replace('-progressive.html', '');
    var feedback = {
        submitted: true,
        timestamp: new Date().toISOString()
    };
    localStorage.setItem(courseId + '-feedback', JSON.stringify(feedback));
    
    alert('Thank you for your feedback! Final exam is now available.');
    
    // Show final exam
    document.getElementById('final-assessment').style.display = 'block';
    document.getElementById('final-exam-content').style.display = 'block';
    initFinalExam();
    
    document.getElementById('final-assessment').scrollIntoView({ behavior: 'smooth' });
}

// Final exam functions
var currentExam = {
    questions: [],
    answers: [],
    currentQuestion: 0,
    submitted: false
};

function initFinalExam() {
    currentExam.questions = courseExamQuestions;
    currentExam.answers = new Array(currentExam.questions.length).fill(null);
    currentExam.currentQuestion = 0;
    displayExamQuestion(0);
}

function displayExamQuestion(index) {
    currentExam.currentQuestion = index;
    var container = document.getElementById('exam-questions-container');
    var question = currentExam.questions[index];
    
    var html = '<div style="background:white;padding:1.5rem;border-radius:8px;margin-bottom:1rem;border:1px solid #e2e8f0;">';
    html += '<div style="font-weight:600;margin-bottom:1rem;color:#1e293b;">Question ' + (index + 1) + ' of ' + currentExam.questions.length + '</div>';
    html += '<div style="margin-bottom:1rem;font-size:1.05rem;">' + question.q + '</div>';
    html += '<div style="display:flex;flex-direction:column;gap:0.5rem;">';
    
    for (var i = 0; i < question.o.length; i++) {
        var selected = currentExam.answers[index] === i ? 'checked' : '';
        html += '<label style="display:flex;align-items:center;padding:0.75rem;background:#f8fafc;border-radius:6px;cursor:pointer;">';
        html += '<input type="radio" name="exam-q' + index + '" value="' + i + '" ' + selected + ' onchange="recordExamAnswer(' + index + ', ' + i + ')" style="margin-right:0.75rem;">';
        html += '<span>' + String.fromCharCode(65 + i) + ') ' + question.o[i] + '</span>';
        html += '</label>';
    }
    
    html += '</div></div>';
    
    // Navigation
    html += '<div style="display:flex;justify-content:space-between;margin-top:1.5rem;">';
    if (index > 0) {
        html += '<button onclick="displayExamQuestion(' + (index - 1) + ')" style="padding:0.75rem 1.5rem;background:#6b7280;color:white;border:none;border-radius:6px;cursor:pointer;">Previous</button>';
    } else {
        html += '<span></span>';
    }
    
    if (index < currentExam.questions.length - 1) {
        html += '<button onclick="displayExamQuestion(' + (index + 1) + ')" style="padding:0.75rem 1.5rem;background:#059669;color:white;border:none;border-radius:6px;cursor:pointer;">Next</button>';
    } else {
        html += '<button onclick="submitFinalExam()" style="padding:0.75rem 1.5rem;background:#dc2626;color:white;border:none;border-radius:6px;font-weight:600;cursor:pointer;">Submit Exam</button>';
    }
    html += '</div>';
    
    // Progress
    var answered = currentExam.answers.filter(function(a) { return a !== null; }).length;
    html += '<div style="text-align:center;margin-top:1rem;color:#64748b;">Progress: ' + answered + '/' + currentExam.questions.length + ' answered</div>';
    
    container.innerHTML = html;
}

function recordExamAnswer(questionIndex, answerIndex) {
    currentExam.answers[questionIndex] = answerIndex;
}

function submitFinalExam() {
    var correct = 0;
    for (var i = 0; i < currentExam.questions.length; i++) {
        if (currentExam.answers[i] === currentExam.questions[i].a) {
            correct++;
        }
    }
    
    var percentage = Math.round((correct / currentExam.questions.length) * 100);
    var passed = percentage >= 70;
    
    var resultsDiv = document.getElementById('exam-results');
    resultsDiv.style.display = 'block';
    resultsDiv.style.background = passed ? '#ecfdf5' : '#fef2f2';
    resultsDiv.style.border = passed ? '2px solid #10b981' : '2px solid #ef4444';
    
    var html = '<h3>' + (passed ? 'Congratulations! You Passed!' : 'Did Not Pass') + '</h3>';
    html += '<p>You scored <strong>' + correct + '/' + currentExam.questions.length + '</strong> (' + percentage + '%)</p>';
    
    if (passed) {
        html += '<p style="color:#059669;font-weight:600;">Your certificate is now available!</p>';
        document.getElementById('certificate-section').style.display = 'block';
        
        var dateStr = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        document.getElementById('cert-completion-date').textContent = dateStr;
        
        var courseId = window.location.pathname.split('/').pop().replace('-progressive.html', '');
        localStorage.setItem(courseId + '-completed', 'true');
    } else {
        html += '<button onclick="retakeExam()" style="margin-top:1rem;padding:0.75rem 1.5rem;background:#2563eb;color:white;border:none;border-radius:6px;cursor:pointer;">Retake Exam</button>';
    }
    
    resultsDiv.innerHTML = html;
}

function retakeExam() {
    currentExam.answers = new Array(currentExam.questions.length).fill(null);
    currentExam.currentQuestion = 0;
    document.getElementById('exam-results').style.display = 'none';
    displayExamQuestion(0);
}

function printCertificate() {
    var certContent = document.getElementById('certificate-content');
    var printWindow = window.open('', '_blank');
    printWindow.document.write('<html><head><title>Certificate</title><style>body{font-family:Arial;margin:20px}</style></head><body>' + certContent.innerHTML + '</body></html>');
    printWindow.document.close();
    printWindow.print();
}

function adminResetProgress() {
    if (!confirm('Reset all progress?')) return;
    var courseId = window.location.pathname.split('/').pop().replace('-progressive.html', '');
    localStorage.removeItem(courseId + '-progress');
    localStorage.removeItem(courseId + '-feedback');
    localStorage.removeItem(courseId + '-completed');
    alert('Progress reset. Reloading...');
    location.reload();
}

function adminShowAnswers() {
    var html = '<h3>Exam Answer Key</h3>';
    for (var i = 0; i < courseExamQuestions.length; i++) {
        var q = courseExamQuestions[i];
        html += '<div style="margin:1rem 0;padding:1rem;background:#f0fdf4;border-radius:6px;">';
        html += '<strong>Q' + (i + 1) + ':</strong> ' + q.q + '<br>';
        html += '<strong>Answer:</strong> ' + String.fromCharCode(65 + q.a) + ') ' + q.o[q.a];
        html += '</div>';
    }
    
    var modal = document.createElement('div');
    modal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:9999;display:flex;align-items:center;justify-content:center;';
    modal.innerHTML = '<div style="background:white;padding:2rem;border-radius:12px;max-width:800px;max-height:80vh;overflow-y:auto;">' + html + '<button onclick="this.parentElement.parentElement.remove()" style="margin-top:1rem;padding:0.75rem 1.5rem;background:#2563eb;color:white;border:none;border-radius:6px;cursor:pointer;">Close</button></div>';
    modal.onclick = function(e) { if (e.target === modal) modal.remove(); };
    document.body.appendChild(modal);
}
</script>
</body>
</html>