<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DrTroy Admin Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700&display=swap" rel="stylesheet">

    <!-- Security headers set via netlify.toml -->

    <!-- Supabase JS v2 CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <!-- DrTroy Supabase client -->
    <script src="js/supabase-client.js?v=20260223"></script>
    <!-- Advanced Course Management System -->
    <script src="js/course-management.js?v=20260224a"></script>

    <!-- Emergency tab switching function -->
    <script>
        console.log('üö® Emergency script loading at:', new Date().toISOString());
        
        // Supabase constants ‚Äî reuse from supabase-client.js (already declared as const there)
        // Do NOT redeclare with const ‚Äî causes SyntaxError (duplicate binding)
        
        // Define function immediately - no dependencies
        function switchMainTab(tabName) {
            console.log('üîÑ Emergency switchMainTab called:', tabName);
            
            try {
                // Remove active from all tabs
                const tabs = document.querySelectorAll('.main-tab');
                const contents = document.querySelectorAll('.tab-content');
                
                console.log('Found tabs:', tabs.length, 'contents:', contents.length);
                
                tabs.forEach(tab => tab.classList.remove('active'));
                contents.forEach(content => content.classList.remove('active'));
                
                // Add active to target button
                const targetButton = document.querySelector(`button[onclick*="${tabName}"]`);
                if (targetButton) {
                    targetButton.classList.add('active');
                    console.log('‚úÖ Button activated');
                } else {
                    console.error('‚ùå Button not found for:', tabName);
                }
                
                // Add active to target content
                const targetContent = document.getElementById(tabName);
                if (targetContent) {
                    targetContent.classList.add('active');
                    console.log('‚úÖ Content activated');
                } else {
                    console.error('‚ùå Content not found:', tabName);
                }
            } catch (error) {
                console.error('‚ùå Error in switchMainTab:', error);
            }
        }
        
        // Also put it on window object
        window.switchMainTab = switchMainTab;
        
        console.log('‚úÖ Emergency switchMainTab defined - testing...');
        console.log('Function exists:', typeof switchMainTab);
        console.log('Window function exists:', typeof window.switchMainTab);
        
        // Add logout function
        async function logout() {
            console.log('üö™ Logout clicked');
            if (confirm('Are you sure you want to logout?')) {
                try {
                    if (window.DrTroySupabase) {
                        await window.DrTroySupabase.signOut();
                        console.log('‚úÖ Supabase signout completed');
                    }
                } catch(e) {
                    console.warn('Supabase signout error:', e);
                }
                // Clear saved tab so next login starts on dashboard
                localStorage.removeItem('currentAdminTab');
                window.location.replace('secure-admin-access-2026.html');
            }
        }
        
        // Make logout global
        window.logout = logout;
        console.log('‚úÖ Logout function defined');
        
        // Add other essential functions
        function updateLastUpdate() {
            try {
                const now = new Date();
                const el = document.getElementById('lastUpdate');
                if (el) {
                    el.textContent = now.toLocaleString('en-US', {
                        timeZone: 'America/Chicago',
                        month: 'short',
                        day: 'numeric',
                        hour: 'numeric',
                        minute: '2-digit',
                        timeZoneName: 'short'
                    });
                }
                console.log('‚úÖ Timestamp updated');
            } catch(e) {
                console.warn('Update timestamp error:', e);
            }
        }
        
        // Basic placeholder data for tabs ‚Äî zeroes until real data loads
        function loadBasicData() {
            try {
                const stats = { totalUsers: '‚Äî', monthlyRevenue: '‚Äî', courseCompletions: '‚Äî', upcomingRenewals: '‚Äî' };
                Object.keys(stats).forEach(key => {
                    const el = document.getElementById(key);
                    if (el) el.textContent = stats[key];
                });
            } catch(e) { /* non-critical */ }
        }
        
        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üìÑ DOM loaded for emergency admin');
            updateLastUpdate();
            loadBasicData();
            
            // Update every minute
            setInterval(updateLastUpdate, 60000);
        });
        
        console.log('‚úÖ Emergency admin functions initialized');
        
        // Override with enhanced version if main script loads successfully
        window.switchMainTabOriginal = window.switchMainTab; // Keep emergency backup
        
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --navy: #1a2e5a;
            --navy-light: #2a4a8a;
            --navy-dark: #0f1d3d;
            --gold: #c8963e;
            --gold-light: #e8b866;
            --gray-50: #f8f9fb;
            --gray-100: #f1f3f7;
            --gray-200: #e2e6ee;
            --gray-300: #d0d5e0;
            --gray-600: #5a6377;
            --gray-900: #1a1e2e;
            --success: #0d9460;
            --danger: #d42b2b;
            --radius: 10px;
            --shadow-sm: 0 1px 2px rgba(26,46,90,0.06);
            --shadow-md: 0 2px 8px rgba(26,46,90,0.08), 0 1px 2px rgba(26,46,90,0.04);
            --shadow-lg: 0 4px 16px rgba(26,46,90,0.10), 0 2px 4px rgba(26,46,90,0.06);
        }

        body {
            font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--gray-100);
            min-height: 100vh;
            color: var(--gray-900);
            -webkit-font-smoothing: antialiased;
        }

        /* ‚îÄ‚îÄ Header ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        .header {
            background: linear-gradient(135deg, var(--navy-dark) 0%, var(--navy) 60%, var(--navy-light) 100%);
            padding: 0 2.5rem;
            height: 64px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 12px rgba(15,29,61,0.25);
        }

        .header-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-logo {
            height: 36px;
            width: auto;
            border-radius: 4px;
        }

        .header-divider {
            width: 1px;
            height: 28px;
            background: rgba(255,255,255,0.2);
        }

        .header-title {
            color: rgba(255,255,255,0.7);
            font-size: 0.85rem;
            font-weight: 500;
            letter-spacing: 0.04em;
            text-transform: uppercase;
        }

        .header h1 {
            color: white;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .header-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.85rem;
            color: rgba(255,255,255,0.6);
        }

        .status-indicator {
            background: rgba(13,148,96,0.25);
            color: #6ee7b7;
            padding: 0.3rem 0.85rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            border: 1px solid rgba(13,148,96,0.3);
            letter-spacing: 0.02em;
        }

        /* ‚îÄ‚îÄ Container & Tabs ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        .container {
            max-width: 1440px;
            margin: 0 auto;
            padding: 1.75rem 2.5rem 2.5rem;
        }

        .main-tabs {
            display: flex;
            gap: 4px;
            background: white;
            padding: 6px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
            margin-bottom: 2rem;
            overflow-x: auto;
        }

        .main-tab {
            background: transparent;
            border: none;
            padding: 0.65rem 1.25rem;
            border-radius: 7px;
            cursor: pointer;
            font-family: 'DM Sans', sans-serif;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            color: var(--gray-600);
            flex: 1;
            text-align: center;
            white-space: nowrap;
        }

        .main-tab.active {
            background: var(--navy);
            color: white;
            box-shadow: 0 2px 8px rgba(26,46,90,0.3);
        }

        .main-tab:hover:not(.active) {
            background: var(--gray-100);
            color: var(--gray-900);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.25s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(6px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        /* ‚îÄ‚îÄ Cards ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        .card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
            margin-bottom: 1.75rem;
            overflow: hidden;
            border: 1px solid var(--gray-200);
        }

        .card-header {
            background: white;
            border-bottom: 1px solid var(--gray-200);
            padding: 1.25rem 1.75rem;
        }

        .card-title {
            color: var(--navy);
            font-size: 1.1rem;
            font-weight: 700;
            letter-spacing: -0.01em;
        }

        .card-body {
            padding: 1.75rem;
        }

        /* ‚îÄ‚îÄ Stats ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.25rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            padding: 1.35rem 1.25rem;
            text-align: center;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--navy), var(--gold));
            opacity: 0;
            transition: opacity 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--navy);
            margin-bottom: 0.35rem;
            letter-spacing: -0.02em;
        }

        .stat-label {
            color: var(--gray-600);
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.04em;
        }

        .sub-tabs {
            display: flex;
            gap: 4px;
            background: var(--gray-100);
            padding: 4px;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .sub-tab {
            background: transparent;
            border: none;
            padding: 0.65rem 1.25rem;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'DM Sans', sans-serif;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            color: var(--gray-600);
            flex: 1;
        }

        .sub-tab.active {
            background: white;
            color: var(--navy);
            box-shadow: var(--shadow-sm);
        }

        .sub-content {
            display: none;
        }

        .sub-content.active {
            display: block;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.4rem;
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--gray-900);
        }

        .form-input,
        .form-select {
            width: 100%;
            padding: 0.65rem 0.9rem;
            border: 1.5px solid var(--gray-200);
            border-radius: 8px;
            font-family: 'DM Sans', sans-serif;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            background: white;
            color: var(--gray-900);
        }

        .form-input:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--navy);
            box-shadow: 0 0 0 3px rgba(26,46,90,0.08);
        }

        .form-input::placeholder {
            color: var(--gray-300);
        }

        .btn {
            padding: 0.65rem 1.35rem;
            border: none;
            border-radius: 8px;
            font-family: 'DM Sans', sans-serif;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--navy);
            color: white;
        }

        .btn-primary:hover {
            background: var(--navy-light);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(26,46,90,0.25);
        }

        .btn-secondary {
            background: var(--gray-100);
            color: var(--gray-900);
            border: 1px solid var(--gray-200);
        }

        .btn-secondary:hover {
            background: var(--gray-200);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .table th,
        .table td {
            padding: 0.85rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--gray-100);
        }

        .table th {
            background: var(--gray-50);
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--gray-600);
        }

        .table tr:hover {
            background: var(--gray-50);
        }

        .success-message {
            background: #ecfdf5;
            border: 1px solid #6ee7b7;
            color: #065f46;
            padding: 0.85rem 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
            font-size: 0.9rem;
        }

        .error-message {
            background: #fef2f2;
            border: 1px solid #fca5a5;
            color: #991b1b;
            padding: 0.85rem 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
            font-size: 0.9rem;
        }

        .info-box {
            background: #fffbeb;
            border: 1px solid #fcd34d;
            color: #92400e;
            padding: 0.85rem 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            font-size: 0.875rem;
        }

        .analytics-metric {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            padding: 1.35rem;
            margin-bottom: 0.75rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .metric-info h3 {
            color: var(--navy);
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 0.35rem;
        }

        .metric-info p {
            color: var(--gray-600);
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .metric-value {
            font-size: 2.25rem;
            font-weight: 700;
            color: var(--gold);
            letter-spacing: -0.02em;
        }

        .code-badge {
            display: inline-block;
            padding: 0.2rem 0.65rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.03em;
        }

        .code-badge.employee {
            background: #dbeafe;
            color: #1e40af;
        }

        .code-badge.marketing {
            background: #fef3cd;
            color: #92400e;
        }

        .status-badge {
            display: inline-block;
            padding: 0.2rem 0.65rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .status-badge.active {
            background: #ecfdf5;
            color: #065f46;
        }

        .status-badge.inactive {
            background: #fef2f2;
            color: #991b1b;
        }

        .status-badge.used {
            background: #eef2ff;
            color: #3730a3;
        }

        /* New Enhanced Styles */
        .activity-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid var(--gray-200);
            transition: background 0.2s;
        }

        .activity-item:hover {
            background: var(--gray-50);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-time {
            color: var(--gray-600);
            font-size: 0.9rem;
            font-weight: 500;
            min-width: 100px;
        }

        .activity-content {
            color: var(--gray-900);
            flex: 1;
            margin-left: 1rem;
        }

        /* Enhanced Status Badges */
        .status-badge.delivered {
            background: #dcfce7;
            color: #166534;
        }

        .status-badge.opened {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .status-badge.bounced {
            background: #fee2e2;
            color: #dc2626;
        }

        .status-badge.warning {
            background: #fef3c7;
            color: #d97706;
        }

        .status-badge.expired {
            background: #fee2e2;
            color: #dc2626;
        }

        .status-badge.draft {
            background: #f3f4f6;
            color: #6b7280;
        }

        /* Course Management */
        .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.25rem;
            margin: 1.5rem 0;
        }

        .course-card {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            padding: 1.35rem;
            transition: all 0.2s;
        }

        .course-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--gray-300);
        }

        .course-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .course-header h3 {
            color: var(--navy);
            margin: 0;
            flex: 1;
            margin-right: 1rem;
        }

        .course-status {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .course-status.active {
            background: #dcfce7;
            color: #166534;
        }

        .course-status.draft {
            background: #f3f4f6;
            color: #6b7280;
        }

        .course-meta {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: var(--gray-600);
        }

        .course-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        /* Campaign Management */
        .campaign-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .campaign-item {
            background: var(--gray-50);
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            padding: 1.5rem;
        }

        .campaign-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .campaign-header h3 {
            color: var(--navy);
            margin: 0;
        }

        .campaign-status {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .campaign-status.active {
            background: #dcfce7;
            color: #166534;
        }

        .campaign-status.draft {
            background: #f3f4f6;
            color: #6b7280;
        }

        .campaign-meta {
            display: flex;
            gap: 2rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: var(--gray-600);
        }

        .campaign-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        /* Template Management */
        .template-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .template-item {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            padding: 1.5rem;
        }

        .template-item h3 {
            color: var(--navy);
            margin: 0 0 0.5rem 0;
        }

        .template-item p {
            color: var(--gray-600);
            margin: 0 0 1rem 0;
        }

        .template-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* License Tracking */
        .license-critical {
            background: #fef2f2;
            border-left: 4px solid #dc2626;
        }

        .license-warning {
            background: #fffbeb;
            border-left: 4px solid #d97706;
        }

        .license-safe {
            background: #f0fdf4;
            border-left: 4px solid #059669;
        }

        .urgent {
            color: #dc2626;
            font-weight: 600;
        }

        .warning {
            color: #d97706;
            font-weight: 600;
        }

        .safe {
            color: #059669;
            font-weight: 600;
        }

        .progress-mini {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .progress-mini .progress-bar {
            background: #e5e7eb;
            border-radius: 4px;
            height: 6px;
            width: 60px;
            position: relative;
            overflow: hidden;
        }

        .progress-mini .progress-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: var(--gold);
            border-radius: 4px;
            width: var(--width, 0%);
        }

        .progress-mini span {
            font-size: 0.8rem;
            color: var(--gray-600);
        }

        /* Renewal Stats */
        .renewal-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .renewal-controls {
            background: var(--gray-50);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .renewal-controls h3 {
            color: var(--navy);
            margin-top: 0;
        }

        /* Button Variants */
        .btn-small {
            background: var(--navy);
            color: white;
            border: none;
            padding: 0.35rem 0.75rem;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'DM Sans', sans-serif;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.15s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-small:hover {
            background: var(--navy-light);
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(26,46,90,0.2);
        }

        .btn-small.danger {
            background: #dc2626;
        }

        .btn-small.danger:hover {
            background: #b91c1c;
        }

        .btn-small.warning {
            background: #d97706;
        }

        .btn-small.warning:hover {
            background: #b45309;
        }

        .btn-small.critical {
            background: #dc2626;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* System Information */
        .system-info {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
        }

        .info-row:first-child span:first-child {
            font-weight: 600;
        }

        /* Security Groups */
        .security-group {
            background: var(--gray-50);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .security-group h4 {
            color: var(--navy);
            margin-top: 0;
            margin-bottom: 1rem;
        }

        .system-group {
            background: var(--gray-50);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .system-group h4 {
            color: var(--navy);
            margin-top: 0;
            margin-bottom: 1rem;
        }

        .warning-box {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 6px;
            padding: 1rem;
            color: #92400e;
        }

        /* Enhanced Table Styles */
        .table tbody tr:hover {
            background: var(--gray-50);
        }

        .table th {
            background: var(--gray-100);
            color: var(--gray-900);
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        /* Responsive Enhancements */
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .main-tabs {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .sub-tabs {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
                height: auto;
                padding: 1rem;
            }

            .header-info {
                flex-wrap: wrap;
                justify-content: center;
                gap: 0.5rem;
            }

            .header-info a,
            .header-info button {
                font-size: 0.75rem;
                padding: 0.35rem 0.75rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .course-grid {
                grid-template-columns: 1fr;
            }

            .campaign-meta {
                flex-direction: column;
                gap: 0.5rem;
            }

            .renewal-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .course-actions,
            .campaign-actions,
            .template-actions {
                flex-direction: column;
            }

            /* Mobile Waitlist Responsiveness */
            #waitlist-table {
                font-size: 0.85rem;
            }
            
            #waitlist-table th,
            #waitlist-table td {
                padding: 0.6rem 0.4rem;
            }
            
            /* Hide less critical columns on mobile */
            #waitlist-table th:first-child,
            #waitlist-table td:first-child {
                display: none;
            }
            
            /* Keep Actions column visible but make it smaller */
            #waitlist-table th:last-child,
            #waitlist-table td:last-child {
                min-width: 80px;
                text-align: center;
            }
            
            #waitlist-table td:last-child .btn-small {
                font-size: 0.7rem;
                padding: 0.3rem 0.6rem;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .header-brand {
                flex-direction: column;
                gap: 0.5rem;
            }

            .header-divider {
                display: none;
            }

            .header-title {
                font-size: 0.75rem;
            }

            .header-logo {
                height: 28px;
            }

            .renewal-stats {
                grid-template-columns: 1fr;
            }

            /* Extra mobile adjustments for waitlist */
            .card-header {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }
            
            .card-header > div:last-child {
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .card-header > div:last-child > div:first-child {
                display: flex;
                justify-content: center;
            }
            
            .card-header > div:last-child > div:last-child {
                display: flex;
                gap: 0.5rem;
                justify-content: center;
            }
            
            /* Stack waitlist table for very small screens */
            #waitlist-table thead {
                display: none;
            }
            
            #waitlist-table,
            #waitlist-table tbody,
            #waitlist-table tr,
            #waitlist-table td {
                display: block;
            }
            
            #waitlist-table tr {
                border: 1px solid var(--gray-200);
                border-radius: 8px;
                padding: 1rem;
                margin-bottom: 1rem;
                background: white;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            #waitlist-table td {
                border: none;
                padding: 0.25rem 0;
                position: relative;
                padding-left: 40%;
            }
            
            #waitlist-table td:before {
                content: attr(data-label);
                position: absolute;
                left: 0;
                width: 35%;
                font-weight: 600;
                color: var(--gray-600);
                font-size: 0.8rem;
            }
            
            #waitlist-table td:first-child:before { content: "#"; }
            #waitlist-table td:nth-child(2):before { content: "Name"; }
            #waitlist-table td:nth-child(3):before { content: "Email"; }
            #waitlist-table td:nth-child(4):before { content: "Discipline"; }
            #waitlist-table td:nth-child(5):before { content: "Signed Up"; }
            #waitlist-table td:nth-child(6):before { content: "Source"; }
            #waitlist-table td:last-child:before { content: "Actions"; }
            
            /* Make the action button full width on mobile card layout */
            #waitlist-table td:last-child {
                padding-left: 0;
                text-align: center;
                margin-top: 0.5rem;
            }
            
            #waitlist-table td:last-child .btn-small {
                width: 100%;
                font-size: 0.8rem;
            }
        }

        /* ‚îÄ‚îÄ User Management Modals ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(15,29,61,0.5);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        .modal-overlay.active { display: flex; }

        .modal-box {
            background: #fff;
            border-radius: 14px;
            padding: 2rem;
            max-width: 700px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 60px rgba(15,29,61,0.25);
        }
        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--gray-100);
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--gray-600);
            line-height: 1;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s;
        }
        .modal-close:hover { background: var(--gray-200); color: var(--gray-900); }
        .modal-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--navy);
            margin-bottom: 1.5rem;
        }
        .modal-section {
            margin-bottom: 1.5rem;
        }
        .modal-section h4 {
            font-size: 1rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 0.5rem;
        }
        .form-grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        @media (max-width: 600px) { .form-grid-2 { grid-template-columns: 1fr; } }

        .badge-admin {
            background: #dbeafe;
            color: #1e40af;
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }
        .badge-user {
            background: #f3f4f6;
            color: #6b7280;
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.8rem;
            display: inline-block;
        }
        .badge-suspended {
            background: #fee2e2;
            color: #dc2626;
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }
        .enrollment-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid #f3f4f6;
        }
        .enrollment-row:last-child { border-bottom: none; }
        .btn-danger {
            background: #dc2626;
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }
        .btn-danger:hover { background: #b91c1c; }
        .btn-warning {
            background: #d97706;
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }
        .btn-warning:hover { background: #b45309; }
        .btn-success {
            background: #059669 !important;
            color: #fff !important;
        }
        .btn-success:hover { background: #047857 !important; }
        .info-message {
            background: #dbeafe;
            border: 1px solid #93c5fd;
            color: #1e40af;
            padding: 0.75rem 1rem;
            border-radius: 6px;
            margin-bottom: 1rem;
        }
        /* Admin toast notification */
        .admin-toast {
            position: fixed;
            top: 76px;
            right: 1rem;
            z-index: 9999;
            padding: 0.85rem 1.25rem;
            border-radius: var(--radius);
            font-weight: 600;
            font-size: 0.875rem;
            box-shadow: var(--shadow-lg);
            animation: fadeInRight 0.3s ease;
        }
        @keyframes fadeInRight {
            from { opacity: 0; transform: translateX(20px); }
            to   { opacity: 1; transform: translateX(0); }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-brand">
            <img src="courses/images/drtroy_logo_transparent.jpg" alt="DrTroy" class="header-logo">
            <div class="header-divider"></div>
            <span class="header-title">Admin Dashboard</span>
        </div>
        <div class="header-info">
            <span class="status-indicator">‚óè Online</span>
            <span style="color:rgba(255,255,255,0.5);font-size:0.8rem;">Updated: <span id="lastUpdate" style="color:rgba(255,255,255,0.7);">Loading...</span></span>
            <a href="my-account.html" style="background:rgba(255,255,255,0.1);color:rgba(255,255,255,0.85);border:1px solid rgba(255,255,255,0.15);padding:0.4rem 1rem;border-radius:7px;text-decoration:none;font-family:'DM Sans',sans-serif;font-size:0.8rem;font-weight:600;transition:all 0.15s;"
               onmouseover="this.style.background='rgba(255,255,255,0.18)'"
               onmouseout="this.style.background='rgba(255,255,255,0.1)'">
                üë§ My Account
            </a>
            <button onclick="logout()" style="background:rgba(255,255,255,0.1);color:rgba(255,255,255,0.85);border:1px solid rgba(255,255,255,0.15);padding:0.4rem 1rem;border-radius:7px;cursor:pointer;font-family:'DM Sans',sans-serif;font-size:0.8rem;font-weight:600;transition:all 0.15s;"
                    onmouseover="this.style.background='rgba(255,255,255,0.18)'"
                    onmouseout="this.style.background='rgba(255,255,255,0.1)'">
                Logout
            </button>
        </div>
    </div>

    <div class="container">
        <!-- Main Navigation -->
        <div class="main-tabs">
            <button class="main-tab active" onclick="switchMainTab('dashboard')">
                üìä Dashboard
            </button>
            <button class="main-tab" onclick="switchMainTab('users')">
                üë• User Management
            </button>
            <button class="main-tab" onclick="switchMainTab('courses')">
                üìö Course Content TEST
            </button>
            <button class="main-tab" onclick="switchMainTab('feedback')">
                ‚≠ê Course Feedback
            </button>
            <button class="main-tab" onclick="switchMainTab('emails')">
                üìß Email System
            </button>
            <button class="main-tab" onclick="switchMainTab('licenses')">
                üéì License Tracking
            </button>
            <button class="main-tab" onclick="switchMainTab('discount-codes')">
                üí∞ Discount Codes
            </button>
            <button class="main-tab" onclick="switchMainTab('credits')">
                üí≥ Credits
            </button>
            <button class="main-tab" onclick="switchMainTab('waitlist')">
                üìã Waitlist
            </button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <!-- Platform Overview -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">üìä Platform Overview</h2>
                </div>
                <div class="card-body">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="totalUsers">0</div>
                            <div class="stat-label">Total Users</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="monthlyRevenue">$0</div>
                            <div class="stat-label">Monthly Revenue</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="courseCompletions">0</div>
                            <div class="stat-label">Course Completions</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="upcomingRenewals">0</div>
                            <div class="stat-label">Upcoming Renewals</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">üîî Recent Activity</h2>
                </div>
                <div class="card-body">
                    <div id="recentActivity">
                        <div class="activity-item">
                            <div class="activity-time">2 hours ago</div>
                            <div class="activity-content">New user registration: Jane Smith (PT)</div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-time">5 hours ago</div>
                            <div class="activity-content">Course completed: Fall Prevention - Dr. Michael Johnson</div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-time">1 day ago</div>
                            <div class="activity-content">License renewal reminder sent to 15 users</div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-time">2 days ago</div>
                            <div class="activity-content">Marketing campaign "Spring2026" launched</div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- User Management Tab -->
        <div id="users" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">üë• User Management</h2>
                    <div style="display: flex; gap: 1rem;">
                        <button class="btn btn-secondary" onclick="exportUsers()">üì• Export Users</button>
                        <button class="btn btn-primary" onclick="showAddUserForm()">üë§ Add User</button>
                    </div>
                </div>
                <div class="card-body">
                    <!-- User Search and Filters -->
                    <div style="display: grid; grid-template-columns: 1fr auto auto; gap: 1rem; margin-bottom: 2rem;">
                        <input type="text" id="userSearch" class="form-input" placeholder="Search users by name, email, or license number">
                        <select id="userFilter" class="form-select">
                            <option value="all">All Users</option>
                            <option value="PT">Physical Therapists</option>
                            <option value="PTA">PT Assistants</option>
                            <option value="OT">Occupational Therapists</option>
                            <option value="COTA">OT Assistants</option>
                        </select>
                        <select id="statusFilter" class="form-select">
                            <option value="all">All Status</option>
                            <option value="active">Active</option>
                            <option value="expired">License Expired</option>
                            <option value="warning">Renewal Warning</option>
                        </select>
                    </div>

                    <!-- Users Table -->
                    <div style="overflow-x: auto;">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Profession</th>
                                    <th>License #</th>
                                    <th>State</th>
                                    <th>Role</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                <tr>
                                    <td colspan="7" style="text-align:center;color:#6b7280;padding:2rem;">
                                        Loading users...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     ADVANCED COURSE MANAGEMENT INTERFACE
     Professional-grade content management system for CE courses
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<!-- Course Management Tab -->
<div id="courses" class="tab-content">
    <!-- Course Overview Dashboard -->
    <div class="card">
        <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;">
            <div>
                <h2 class="card-title">üìö Course Management</h2>
                <p style="color:#64748b;margin-top:.5rem;font-size:.95rem;">Create, manage, and publish your continuing education courses</p>
            </div>
            <div style="display:flex;gap:.75rem;align-items:center;flex-wrap:wrap;">
                <select id="courseStatusFilter" onchange="filterCourses()" class="form-input" style="width:auto;">
                    <option value="all">All Courses</option>
                    <option value="draft">Drafts</option>
                    <option value="review">In Review</option>
                    <option value="published">Published</option>
                    <option value="retired">Retired</option>
                </select>
                <button onclick="refreshCourses()" class="btn btn-secondary">üîÑ Refresh</button>
                <button onclick="showCreateCourseModal()" class="btn btn-primary">‚ûï Create Course</button>
            </div>
        </div>
        
        <!-- Course Analytics Dashboard -->
        <div class="card-body">
            <div class="stats-grid" style="margin-bottom:2rem;">
                <div class="stat-card">
                    <div class="stat-number" id="courseStatTotal">‚Äî</div>
                    <div class="stat-label">Total Courses</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="courseStatPublished">‚Äî</div>
                    <div class="stat-label">Published</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="courseStatDrafts">‚Äî</div>
                    <div class="stat-label">Drafts</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="courseStatCeuHours">‚Äî</div>
                    <div class="stat-label">Total CEU Hours</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="courseStatRevenue">$0</div>
                    <div class="stat-label">Course Revenue</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="courseStatCompletions">‚Äî</div>
                    <div class="stat-label">Completions</div>
                </div>
            </div>
            
            <!-- Search and Filters -->
            <div style="display:flex;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap;">
                <input type="text" id="courseSearch" placeholder="Search courses..." oninput="searchCourses()" 
                       class="form-input" style="flex:1;min-width:250px;">
                <select id="courseCategoryFilter" onchange="filterCourses()" class="form-input" style="width:auto;">
                    <option value="">All Categories</option>
                    <option value="musculoskeletal">Musculoskeletal</option>
                    <option value="neurological">Neurological</option>
                    <option value="cardiopulmonary">Cardiopulmonary</option>
                    <option value="ethics">Ethics</option>
                    <option value="pediatric">Pediatric</option>
                    <option value="geriatric">Geriatric</option>
                </select>
                <select id="courseProfessionFilter" onchange="filterCourses()" class="form-input" style="width:auto;">
                    <option value="">All Professions</option>
                    <option value="PT">Physical Therapist</option>
                    <option value="PTA">Physical Therapist Assistant</option>
                    <option value="OT">Occupational Therapist</option>
                    <option value="COTA">Certified OT Assistant</option>
                </select>
            </div>
            
            <!-- Course List -->
            <div id="courseListContainer">
                <div class="loading-state" style="text-align:center;color:#64748b;padding:3rem;">
                    <div style="font-size:3rem;margin-bottom:1rem;">üìö</div>
                    <p>Loading courses...</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     COURSE CREATION/EDITING MODAL
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<div class="modal-overlay" id="courseModal">
    <div class="modal-box" style="max-width:900px;max-height:90vh;overflow-y:auto;">
        <button class="modal-close" onclick="closeCourseModal()">√ó</button>
        
        <!-- Modal Header -->
        <div class="modal-title-section">
            <h3 id="courseModalTitle">Create New Course</h3>
            <div id="courseModalStatus" style="display:none;"></div>
        </div>
        
        <!-- Course Form -->
        <form id="courseForm" onsubmit="saveCourse(event)">
            <input type="hidden" id="courseId">
            
            <!-- Basic Information -->
            <div class="form-section">
                <h4 class="form-section-title">üìã Basic Information</h4>
                
                <div class="form-grid">
                    <div class="form-group" style="grid-column:1/-1;">
                        <label class="form-label">Course Title *</label>
                        <input type="text" id="courseTitle" class="form-input" required 
                               placeholder="Advanced Musculoskeletal Assessment">
                    </div>
                    
                    <div class="form-group" style="grid-column:1/-1;">
                        <label class="form-label">Subtitle</label>
                        <input type="text" id="courseSubtitle" class="form-input" 
                               placeholder="Evidence-based evaluation techniques">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">URL Slug *</label>
                        <input type="text" id="courseSlug" class="form-input" required 
                               placeholder="advanced-msk-assessment">
                        <small class="form-help">Used in URL: drtroy.com/courses/{slug}</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select id="courseStatus" class="form-input">
                            <option value="draft">Draft</option>
                            <option value="review">Ready for Review</option>
                            <option value="published">Published</option>
                            <option value="retired">Retired</option>
                        </select>
                    </div>
                    
                    <div class="form-group" style="grid-column:1/-1;">
                        <label class="form-label">Description</label>
                        <textarea id="courseDescription" class="form-input" rows="4"
                                  placeholder="Comprehensive course covering..."></textarea>
                    </div>
                </div>
            </div>
            
            <!-- CE Credits and Compliance -->
            <div class="form-section">
                <h4 class="form-section-title">üèÜ CE Credits & Compliance</h4>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">CEU Hours *</label>
                        <input type="number" id="courseCeuHours" class="form-input" step="0.5" min="0.5" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">CE Category</label>
                        <select id="courseCeCategory" class="form-input">
                            <option value="general">General</option>
                            <option value="ethics">Ethics</option>
                            <option value="specialty">Specialty</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Category</label>
                        <select id="courseCategory" class="form-input">
                            <option value="">Select Category</option>
                            <option value="musculoskeletal">Musculoskeletal</option>
                            <option value="neurological">Neurological</option>
                            <option value="cardiopulmonary">Cardiopulmonary</option>
                            <option value="pediatric">Pediatric</option>
                            <option value="geriatric">Geriatric</option>
                            <option value="ethics">Ethics</option>
                            <option value="documentation">Documentation</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Difficulty Level</label>
                        <select id="courseDifficulty" class="form-input">
                            <option value="beginner">Beginner</option>
                            <option value="intermediate">Intermediate</option>
                            <option value="advanced">Advanced</option>
                        </select>
                    </div>
                    
                    <div class="form-group" style="grid-column:1/-1;">
                        <label class="form-label">Target Audience</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" id="targetPT"> Physical Therapist (PT)</label>
                            <label><input type="checkbox" id="targetPTA"> Physical Therapist Assistant (PTA)</label>
                            <label><input type="checkbox" id="targetOT"> Occupational Therapist (OT)</label>
                            <label><input type="checkbox" id="targetCOTA"> Certified OT Assistant (COTA)</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Learning Objectives -->
            <div class="form-section">
                <h4 class="form-section-title">üéØ Learning Objectives</h4>
                <p class="form-section-desc">Define what students will learn in this course</p>
                
                <div id="learningObjectivesContainer">
                    <!-- Dynamic objectives list -->
                </div>
                <button type="button" onclick="addLearningObjective()" class="btn btn-secondary">+ Add Objective</button>
            </div>
            
            <!-- Pricing and Business -->
            <div class="form-section">
                <h4 class="form-section-title">üí∞ Pricing & Business</h4>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Price</label>
                        <div class="input-group">
                            <span class="input-prefix">$</span>
                            <input type="number" id="coursePrice" class="form-input" step="0.01" min="0" 
                                   placeholder="49.00">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Package Only</label>
                        <select id="coursePackageOnly" class="form-input">
                            <option value="false">Available Individually</option>
                            <option value="true">Package Only</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Featured Course</label>
                        <select id="courseFeatured" class="form-input">
                            <option value="false">No</option>
                            <option value="true">Yes</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Sort Order</label>
                        <input type="number" id="courseSortOrder" class="form-input" value="0">
                    </div>
                </div>
            </div>
            
            <!-- Media and Assets -->
            <div class="form-section">
                <h4 class="form-section-title">üé¨ Media & Assets</h4>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Thumbnail Image URL</label>
                        <input type="url" id="courseThumbnail" class="form-input" 
                               placeholder="https://example.com/course-thumbnail.jpg">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Preview Video URL</label>
                        <input type="url" id="coursePreviewVideo" class="form-input" 
                               placeholder="https://vimeo.com/123456789">
                    </div>
                </div>
            </div>
            
            <!-- SEO and Marketing -->
            <div class="form-section">
                <h4 class="form-section-title">üîç SEO & Marketing</h4>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Meta Title</label>
                        <input type="text" id="courseMetaTitle" class="form-input" maxlength="60"
                               placeholder="Advanced Musculoskeletal Assessment Course">
                        <small class="form-help">60 characters max</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Meta Description</label>
                        <textarea id="courseMetaDescription" class="form-input" rows="2" maxlength="160"
                                  placeholder="Learn evidence-based assessment techniques..."></textarea>
                        <small class="form-help">160 characters max</small>
                    </div>
                    
                    <div class="form-group" style="grid-column:1/-1;">
                        <label class="form-label">Tags</label>
                        <input type="text" id="courseTags" class="form-input" 
                               placeholder="orthopedic, assessment, manual therapy">
                        <small class="form-help">Comma-separated tags for search</small>
                    </div>
                </div>
            </div>
            
            <!-- Form Actions -->
            <div class="form-actions">
                <button type="button" onclick="closeCourseModal()" class="btn btn-secondary">Cancel</button>
                <button type="submit" class="btn btn-primary">Save Course</button>
            </div>
        </form>
    </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     COURSE CONTENT EDITOR MODAL
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<div class="modal-overlay" id="courseContentModal">
    <div class="modal-box" style="max-width:1200px;max-height:95vh;overflow-y:auto;">
        <button class="modal-close" onclick="closeCourseContentModal()">√ó</button>
        
        <div class="modal-title-section">
            <h3 id="courseContentModalTitle">Course Content TEST Editor</h3>
            <div style="display:flex;gap:1rem;align-items:center;">
                <button onclick="saveAllContent()" class="btn btn-primary">üíæ Save All</button>
                <button onclick="previewCourse()" class="btn btn-secondary">üëÅÔ∏è Preview</button>
            </div>
        </div>
        
        <!-- Course Content TEST Structure -->
        <div style="display:grid;grid-template-columns:300px 1fr;gap:2rem;height:70vh;">
            <!-- Module Tree -->
            <div style="border:1px solid #e2e8f0;border-radius:12px;overflow:hidden;">
                <div style="background:#f8fafc;padding:1rem;border-bottom:1px solid #e2e8f0;display:flex;justify-content:space-between;align-items:center;">
                    <h4 style="margin:0;">Course Structure</h4>
                    <button onclick="addModule()" class="btn btn-small btn-primary">+ Module</button>
                </div>
                <div id="moduleTree" style="padding:1rem;overflow-y:auto;height:calc(100% - 60px);">
                    <!-- Dynamic module/lesson tree -->
                </div>
            </div>
            
            <!-- Content Editor -->
            <div style="border:1px solid #e2e8f0;border-radius:12px;overflow:hidden;">
                <div style="background:#f8fafc;padding:1rem;border-bottom:1px solid #e2e8f0;">
                    <h4 id="contentEditorTitle" style="margin:0;">Select content to edit</h4>
                </div>
                <div id="contentEditor" style="padding:1rem;overflow-y:auto;height:calc(100% - 60px);">
                    <div style="text-align:center;color:#64748b;padding:3rem;">
                        <div style="font-size:3rem;margin-bottom:1rem;">üìù</div>
                        <p>Select a module or lesson from the left to edit its content</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     STYLES FOR COURSE MANAGEMENT
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<style>
.course-card {
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 1rem;
    transition: all 0.2s;
    background: white;
}

.course-card:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    border-color: #cbd5e0;
}

.course-card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 1rem;
}

.course-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: #1a365d;
    margin: 0;
    line-height: 1.3;
}

.course-subtitle {
    color: #64748b;
    font-size: 0.9rem;
    margin: 0.25rem 0 0;
}

.course-status {
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.course-status.draft {
    background: #fef3c7;
    color: #92400e;
}

.course-status.review {
    background: #ddd6fe;
    color: #6b46c1;
}

.course-status.published {
    background: #d1fae5;
    color: #065f46;
}

.course-status.retired {
    background: #fee2e2;
    color: #991b1b;
}

.course-meta {
    display: flex;
    gap: 1.5rem;
    margin: 1rem 0;
    flex-wrap: wrap;
}

.course-meta-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #64748b;
    font-size: 0.875rem;
}

.course-actions {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.course-description {
    color: #4b5563;
    line-height: 1.6;
    margin: 1rem 0;
}

.learning-objectives {
    background: #f8fafc;
    border-radius: 8px;
    padding: 1rem;
    margin: 1rem 0;
}

.learning-objectives h5 {
    margin: 0 0 0.5rem;
    color: #374151;
    font-size: 0.875rem;
    font-weight: 600;
}

.learning-objectives ul {
    margin: 0;
    padding-left: 1.5rem;
    color: #4b5563;
}

.learning-objectives li {
    margin-bottom: 0.25rem;
}

.form-section {
    margin-bottom: 2rem;
    padding: 1.5rem;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    background: #f9fafb;
}

.form-section-title {
    margin: 0 0 0.5rem;
    font-size: 1.1rem;
    font-weight: 600;
    color: #374151;
}

.form-section-desc {
    margin: 0 0 1rem;
    color: #6b7280;
    font-size: 0.875rem;
}

.checkbox-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.checkbox-group label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: normal;
    color: #374151;
}

.input-group {
    position: relative;
    display: flex;
}

.input-prefix {
    background: #f3f4f6;
    border: 2px solid #d1d5db;
    border-right: none;
    border-radius: 8px 0 0 8px;
    padding: 0.75rem 1rem;
    color: #6b7280;
    font-weight: 500;
    display: flex;
    align-items: center;
}

.input-group .form-input {
    border-radius: 0 8px 8px 0;
    border-left: none;
}

.form-actions {
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    padding-top: 1.5rem;
    border-top: 1px solid #e5e7eb;
    margin-top: 2rem;
}

.module-item {
    padding: 0.75rem;
    border-radius: 6px;
    margin-bottom: 0.5rem;
    cursor: pointer;
    transition: background-color 0.2s;
}

.module-item:hover {
    background: #f1f5f9;
}

.module-item.active {
    background: #dbeafe;
    border-left: 3px solid #3b82f6;
}

.lesson-item {
    padding: 0.5rem 0.5rem 0.5rem 1.5rem;
    margin: 0.25rem 0;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.875rem;
    color: #64748b;
}

.lesson-item:hover {
    background: #f8fafc;
    color: #475569;
}

.lesson-item.active {
    background: #eff6ff;
    color: #1d4ed8;
}
</style>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             COURSE FEEDBACK TAB
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="feedback" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">‚≠ê Course Feedback</h2>
                    <p style="color:#64748b;margin-top:.5rem;font-size:.95rem;">View aggregated feedback ratings and individual responses.</p>
                </div>
                <div class="card-body">
                    <!-- Course Selector -->
                    <div style="margin-bottom:1.5rem;">
                        <label style="font-weight:600;font-size:.85rem;color:#374151;display:block;margin-bottom:.4rem;">Select Course</label>
                        <select id="feedback-course-select" onchange="loadFeedbackStats()" style="width:100%;padding:.75rem;border:1px solid #d1d5db;border-radius:6px;font-size:.95rem;">
                            <option value="">All Courses</option>
                            <option value="pt-msk-001">MSK Evaluation & Management (3.0 CEU)</option>
                            <option value="balance-gait-001">Balance, Gait & Vestibular (3.0 CEU)</option>
                        </select>
                    </div>

                    <!-- Stats Overview -->
                    <div id="feedback-stats-container" style="display:none;">
                        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:2rem;">
                            <div style="background:linear-gradient(135deg,#7c3aed,#a855f7);color:#fff;padding:1.25rem;border-radius:8px;">
                                <div style="font-size:.875rem;opacity:.9;margin-bottom:.25rem;">Total Responses</div>
                                <div id="stat-total-responses" style="font-size:2rem;font-weight:700;">0</div>
                            </div>
                            <div style="background:linear-gradient(135deg,#059669,#10b981);color:#fff;padding:1.25rem;border-radius:8px;">
                                <div style="font-size:.875rem;opacity:.9;margin-bottom:.25rem;">Overall Rating</div>
                                <div id="stat-overall-rating" style="font-size:2rem;font-weight:700;">0.0</div>
                                <div style="font-size:.75rem;opacity:.8;">out of 5</div>
                            </div>
                            <div style="background:linear-gradient(135deg,#2563eb,#3b82f6);color:#fff;padding:1.25rem;border-radius:8px;">
                                <div style="font-size:.875rem;opacity:.9;margin-bottom:.25rem;">Would Recommend</div>
                                <div id="stat-recommend-yes" style="font-size:2rem;font-weight:700;">0%</div>
                            </div>
                        </div>

                        <!-- Detailed Ratings -->
                        <h3 style="font-size:1.1rem;font-weight:600;margin:1.5rem 0 1rem;">Detailed Ratings (Average)</h3>
                        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:1rem;margin-bottom:2rem;">
                            <div style="background:#f8fafc;padding:1rem;border-radius:8px;border:1px solid #e2e8f0;">
                                <div style="font-size:.8rem;color:#64748b;margin-bottom:.25rem;">Content Quality</div>
                                <div id="stat-content-quality" style="font-size:1.5rem;font-weight:700;color:#1e293b;">0.0</div>
                            </div>
                            <div style="background:#f8fafc;padding:1rem;border-radius:8px;border:1px solid #e2e8f0;">
                                <div style="font-size:.8rem;color:#64748b;margin-bottom:.25rem;">Learning Format</div>
                                <div id="stat-format-rating" style="font-size:1.5rem;font-weight:700;color:#1e293b;">0.0</div>
                            </div>
                            <div style="background:#f8fafc;padding:1rem;border-radius:8px;border:1px solid #e2e8f0;">
                                <div style="font-size:.8rem;color:#64748b;margin-bottom:.25rem;">Objectives Met</div>
                                <div id="stat-objectives-met" style="font-size:1.5rem;font-weight:700;color:#1e293b;">0.0</div>
                            </div>
                            <div style="background:#f8fafc;padding:1rem;border-radius:8px;border:1px solid #e2e8f0;">
                                <div style="font-size:.8rem;color:#64748b;margin-bottom:.25rem;">Practice Relevance</div>
                                <div id="stat-practice-relevance" style="font-size:1.5rem;font-weight:700;color:#1e293b;">0.0</div>
                            </div>
                        </div>

                        <!-- Recommend Breakdown -->
                        <h3 style="font-size:1.1rem;font-weight:600;margin:1.5rem 0 1rem;">Recommendation Breakdown</h3>
                        <div style="display:flex;gap:1rem;margin-bottom:2rem;">
                            <div style="flex:1;background:#ecfdf5;padding:1rem;border-radius:8px;border:1px solid #a7f3d0;text-align:center;">
                                <div style="font-size:1.5rem;font-weight:700;color:#059669;" id="stat-recommend-yes-count">0</div>
                                <div style="font-size:.8rem;color:#047857;">Yes, definitely</div>
                            </div>
                            <div style="flex:1;background:#fef3c7;padding:1rem;border-radius:8px;border:1px solid #fde68a;text-align:center;">
                                <div style="font-size:1.5rem;font-weight:700;color:#d97706;" id="stat-recommend-maybe-count">0</div>
                                <div style="font-size:.8rem;color:#b45309;">Maybe</div>
                            </div>
                            <div style="flex:1;background:#fee2e2;padding:1rem;border-radius:8px;border:1px solid #fecaca;text-align:center;">
                                <div style="font-size:1.5rem;font-weight:700;color:#dc2626;" id="stat-recommend-no-count">0</div>
                                <div style="font-size:.8rem;color:#b91c1c;">No</div>
                            </div>
                        </div>

                        <!-- Recent Feedback -->
                        <h3 style="font-size:1.1rem;font-weight:600;margin:1.5rem 0 1rem;">Recent Feedback</h3>
                        <div id="recent-feedback-list" style="max-height:400px;overflow-y:auto;">
                            <!-- Dynamically populated -->
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div id="feedback-loading" style="display:none;text-align:center;padding:2rem;">
                        <div style="font-size:1.1rem;color:#64748b;">Loading feedback data...</div>
                    </div>

                    <!-- No Data State -->
                    <div id="feedback-no-data" style="display:none;text-align:center;padding:2rem;background:#f8fafc;border-radius:8px;border:1px dashed #cbd5e1;">
                        <div style="font-size:1.1rem;color:#64748b;margin-bottom:.5rem;">No feedback data yet</div>
                        <div style="font-size:.9rem;color:#94a3b8;">Feedback will appear here when students submit their course evaluations.</div>
                    </div>
                </div>
            </div>
        </div>

        <script>
        // Load feedback statistics
        async function loadFeedbackStats() {
            const courseId = document.getElementById('feedback-course-select').value;
            const container = document.getElementById('feedback-stats-container');
            const loading = document.getElementById('feedback-loading');
            const noData = document.getElementById('feedback-no-data');

            // Show loading
            container.style.display = 'none';
            noData.style.display = 'none';
            loading.style.display = 'block';

            try {
                const session = await window.DrTroySupabase.getSession();
                if (!session) {
                    showAdminToast('Please log in to view feedback', 'error');
                    return;
                }

                const url = courseId 
                    ? '/.netlify/functions/get-course-feedback-stats?course_id=' + courseId
                    : '/.netlify/functions/get-course-feedback-stats';

                const response = await fetch(url, {
                    headers: {
                        'Authorization': 'Bearer ' + session.access_token
                    }
                });

                const result = await response.json();

                if (!response.ok) {
                    throw new Error(result.error || 'Failed to load feedback');
                }

                const stats = result.stats;

                if (stats.total_responses === 0) {
                    loading.style.display = 'none';
                    noData.style.display = 'block';
                    return;
                }

                // Calculate totals for all courses or specific course
                let totalResponses = 0;
                let overallSum = 0, overallCount = 0;
                let contentSum = 0, contentCount = 0;
                let formatSum = 0, formatCount = 0;
                let objectivesSum = 0, objectivesCount = 0;
                let relevanceSum = 0, relevanceCount = 0;
                let recommendYes = 0, recommendMaybe = 0, recommendNo = 0;

                Object.values(stats.by_course).forEach(course => {
                    totalResponses += course.total_responses;
                    
                    overallSum += course.overall_rating.sum;
                    overallCount += course.overall_rating.count;
                    
                    contentSum += course.content_quality.sum;
                    contentCount += course.content_quality.count;
                    
                    formatSum += course.format_rating.sum;
                    formatCount += course.format_rating.count;
                    
                    objectivesSum += course.objectives_met.sum;
                    objectivesCount += course.objectives_met.count;
                    
                    relevanceSum += course.practice_relevance.sum;
                    relevanceCount += course.practice_relevance.count;
                    
                    recommendYes += course.recommend.yes;
                    recommendMaybe += course.recommend.maybe;
                    recommendNo += course.recommend.no;
                });

                // Update display
                document.getElementById('stat-total-responses').textContent = totalResponses;
                document.getElementById('stat-overall-rating').textContent = overallCount > 0 ? (overallSum / overallCount).toFixed(1) : '0.0';
                document.getElementById('stat-content-quality').textContent = contentCount > 0 ? (contentSum / contentCount).toFixed(1) : '0.0';
                document.getElementById('stat-format-rating').textContent = formatCount > 0 ? (formatSum / formatCount).toFixed(1) : '0.0';
                document.getElementById('stat-objectives-met').textContent = objectivesCount > 0 ? (objectivesSum / objectivesCount).toFixed(1) : '0.0';
                document.getElementById('stat-practice-relevance').textContent = relevanceCount > 0 ? (relevanceSum / relevanceCount).toFixed(1) : '0.0';

                const totalRecommend = recommendYes + recommendMaybe + recommendNo;
                const recommendYesPercent = totalRecommend > 0 ? Math.round((recommendYes / totalRecommend) * 100) : 0;
                document.getElementById('stat-recommend-yes').textContent = recommendYesPercent + '%';
                document.getElementById('stat-recommend-yes-count').textContent = recommendYes;
                document.getElementById('stat-recommend-maybe-count').textContent = recommendMaybe;
                document.getElementById('stat-recommend-no-count').textContent = recommendNo;

                // Populate recent feedback
                const recentList = document.getElementById('recent-feedback-list');
                recentList.innerHTML = '';

                // Collect all recent feedback from all courses
                let allRecent = [];
                Object.values(stats.by_course).forEach(course => {
                    allRecent = allRecent.concat(course.recent_feedback.map(f => ({...f, course_id: course.course_id})));
                });

                // Sort by date (newest first) and take top 10
                allRecent.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
                allRecent = allRecent.slice(0, 10);

                if (allRecent.length === 0) {
                    recentList.innerHTML = '<div style="text-align:center;color:#64748b;padding:1rem;">No detailed feedback yet</div>';
                } else {
                    allRecent.forEach(feedback => {
                        const item = document.createElement('div');
                        item.style.cssText = 'background:#f8fafc;padding:1rem;border-radius:8px;border:1px solid #e2e8f0;margin-bottom:.75rem;';
                        
                        const date = new Date(feedback.created_at).toLocaleDateString();
                        const stars = '‚≠ê'.repeat(feedback.overall_rating || 0);
                        
                        item.innerHTML = `
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem;">
                                <span style="font-weight:600;color:#1e293b;">${feedback.course_id}</span>
                                <span style="font-size:.8rem;color:#64748b;">${date}</span>
                            </div>
                            <div style="margin-bottom:.5rem;">${stars}</div>
                            ${feedback.improvements ? `<div style="font-size:.9rem;color:#475569;font-style:italic;">"${feedback.improvements.substring(0, 100)}${feedback.improvements.length > 100 ? '...' : ''}"</div>` : ''}
                            <div style="display:flex;gap:1rem;margin-top:.5rem;font-size:.8rem;color:#64748b;">
                                <span>Content: ${feedback.content_quality || '-'}</span>
                                <span>Format: ${feedback.format_rating || '-'}</span>
                                <span>Objectives: ${feedback.objectives_met || '-'}</span>
                                <span>Relevance: ${feedback.practice_relevance || '-'}</span>
                                <span>Recommend: ${feedback.recommend || '-'}</span>
                            </div>
                        `;
                        recentList.appendChild(item);
                    });
                }

                loading.style.display = 'none';
                container.style.display = 'block';

            } catch (error) {
                console.error('Error loading feedback:', error);
                loading.style.display = 'none';
                showAdminToast('Error loading feedback: ' + error.message, 'error');
            }
        }

        // Load feedback when tab is opened
        document.addEventListener('DOMContentLoaded', function() {
            // Check if we're on the feedback tab
            const observer = new MutationObserver(function(mutations) {
                const feedbackTab = document.getElementById('feedback');
                if (feedbackTab && feedbackTab.classList.contains('active')) {
                    loadFeedbackStats();
                }
            });

            const tabContainer = document.querySelector('.main-tabs');
            if (tabContainer) {
                observer.observe(tabContainer, { attributes: true, subtree: true });
            }
        });
        </script>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             EMAIL SYSTEM TAB
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="emails" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">üìß Email Campaigns</h2>
                    <p style="color:#64748b;margin-top:.5rem;font-size:.95rem;">Send targeted emails to users based on filters.</p>
                </div>
                <div class="card-body">
                    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:1rem;margin-bottom:1.5rem;">
                        <div>
                            <label style="font-weight:600;font-size:.85rem;color:#374151;display:block;margin-bottom:.4rem;">Profession</label>
                            <select id="campaign-profession" class="form-input" onchange="previewCampaignCount()">
                                <option value="">All Professions</option>
                                <option value="PT">PT</option>
                                <option value="PTA">PTA</option>
                                <option value="OT">OT</option>
                                <option value="COTA">COTA</option>
                                <option value="SLP">SLP</option>
                            </select>
                        </div>
                        <div>
                            <label style="font-weight:600;font-size:.85rem;color:#374151;display:block;margin-bottom:.4rem;">State</label>
                            <input type="text" id="campaign-state" class="form-input" placeholder="e.g. TX" maxlength="2" oninput="this.value=this.value.toUpperCase();previewCampaignCount()">
                        </div>
                        <div>
                            <label style="font-weight:600;font-size:.85rem;color:#374151;display:block;margin-bottom:.4rem;">Enrolled in Course</label>
                            <select id="campaign-course" class="form-input" onchange="previewCampaignCount()">
                                <option value="">Any Course</option>
                            </select>
                        </div>
                    </div>
                    <div id="campaign-count" style="background:#f0f9ff;border:1px solid #bae6fd;border-radius:8px;padding:.75rem 1rem;margin-bottom:1.5rem;font-size:.9rem;color:#0369a1;font-weight:600;">
                        Set filters above, then click Preview to count recipients.
                    </div>
                    <button onclick="previewCampaignCount()" class="btn btn-secondary" style="margin-bottom:1.5rem;">üîç Preview Recipient Count</button>
                    <div style="margin-bottom:1rem;">
                        <label style="font-weight:600;font-size:.85rem;color:#374151;display:block;margin-bottom:.4rem;">Subject Line</label>
                        <input type="text" id="campaign-subject" class="form-input" placeholder="e.g. New CE Course Available!">
                    </div>
                    <div style="margin-bottom:1.5rem;">
                        <label style="font-weight:600;font-size:.85rem;color:#374151;display:block;margin-bottom:.4rem;">Email Body (HTML supported)</label>
                        <textarea id="campaign-body" class="form-input" rows="8" placeholder="Write your email content here. HTML tags are supported."></textarea>
                    </div>
                    <div style="display:flex;gap:1rem;align-items:center;">
                        <button id="campaign-send-btn" onclick="sendCampaignEmail()" class="btn btn-primary">üöÄ Send Campaign</button>
                        <div id="campaign-result" style="display:none;font-weight:600;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             LICENSE TRACKING TAB
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="licenses" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">üìã License Tracking</h2>
                    <p style="color:#64748b;margin-top:.5rem;font-size:.95rem;">Track professional license expiry dates and renewal status.</p>
                </div>
                <div class="card-body">
                    <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;margin-bottom:1.5rem;">
                        <div class="stat-card" style="background:#fef2f2;border:1px solid #fecaca;border-radius:10px;padding:1rem;text-align:center;">
                            <div style="font-size:1.8rem;font-weight:700;color:#dc2626;" id="licExpired">‚Äî</div>
                            <div style="font-size:.8rem;color:#991b1b;font-weight:600;">Expired</div>
                        </div>
                        <div class="stat-card" style="background:#fff7ed;border:1px solid #fed7aa;border-radius:10px;padding:1rem;text-align:center;">
                            <div style="font-size:1.8rem;font-weight:700;color:#ea580c;" id="licExpiring30">‚Äî</div>
                            <div style="font-size:.8rem;color:#9a3412;font-weight:600;">Within 30 Days</div>
                        </div>
                        <div class="stat-card" style="background:#fefce8;border:1px solid #fde68a;border-radius:10px;padding:1rem;text-align:center;">
                            <div style="font-size:1.8rem;font-weight:700;color:#ca8a04;" id="licExpiring90">‚Äî</div>
                            <div style="font-size:.8rem;color:#854d0e;font-weight:600;">Within 90 Days</div>
                        </div>
                        <div class="stat-card" style="background:#f0fdf4;border:1px solid #bbf7d0;border-radius:10px;padding:1rem;text-align:center;">
                            <div style="font-size:1.8rem;font-weight:700;color:#16a34a;" id="licWithDate">‚Äî</div>
                            <div style="font-size:.8rem;color:#166534;font-weight:600;">Total Tracked</div>
                        </div>
                    </div>
                    <div style="overflow-x:auto;">
                        <table class="data-table" style="width:100%;border-collapse:collapse;">
                            <thead>
                                <tr style="background:#f8fafc;border-bottom:2px solid #e2e8f0;">
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">Name</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">Email</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">License #</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">State</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">Profession</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">Expiry</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">Status</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">Action</th>
                                </tr>
                            </thead>
                            <tbody id="licenseTableBody">
                                <tr><td colspan="8" style="text-align:center;color:#6b7280;padding:2rem;">Loading license data...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             DISCOUNT CODES TAB
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="discount-codes" class="tab-content">
            <div class="card">
                <div class="card-header" style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:1rem;">
                    <div>
                        <h2 class="card-title">üè∑Ô∏è Discount Codes</h2>
                        <p style="color:#64748b;margin-top:.5rem;font-size:.95rem;">Manage promotional and employee discount codes.</p>
                    </div>
                    <button onclick="loadDiscountCodesFromDB()" class="btn btn-secondary">‚Üª Refresh</button>
                </div>
                <div class="card-body">
                    <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;margin-bottom:1.5rem;">
                        <div class="stat-card" style="background:#eff6ff;border:1px solid #bfdbfe;border-radius:10px;padding:1rem;text-align:center;">
                            <div style="font-size:1.8rem;font-weight:700;color:#2563eb;" id="totalCodes">‚Äî</div>
                            <div style="font-size:.8rem;color:#1e40af;font-weight:600;">Total Codes</div>
                        </div>
                        <div class="stat-card" style="background:#f0fdf4;border:1px solid #bbf7d0;border-radius:10px;padding:1rem;text-align:center;">
                            <div style="font-size:1.8rem;font-weight:700;color:#16a34a;" id="activeCodes">‚Äî</div>
                            <div style="font-size:.8rem;color:#166534;font-weight:600;">Active</div>
                        </div>
                        <div class="stat-card" style="background:#faf5ff;border:1px solid #e9d5ff;border-radius:10px;padding:1rem;text-align:center;">
                            <div style="font-size:1.8rem;font-weight:700;color:#7c3aed;" id="usedCodes">‚Äî</div>
                            <div style="font-size:.8rem;color:#5b21b6;font-weight:600;">Total Uses</div>
                        </div>
                        <div class="stat-card" style="background:#fff7ed;border:1px solid #fed7aa;border-radius:10px;padding:1rem;text-align:center;">
                            <div style="font-size:1.8rem;font-weight:700;color:#ea580c;" id="totalSavings">‚Äî</div>
                            <div style="font-size:.8rem;color:#9a3412;font-weight:600;">Total Savings</div>
                        </div>
                    </div>
                    <div style="overflow-x:auto;">
                        <table class="data-table" style="width:100%;border-collapse:collapse;">
                            <thead>
                                <tr style="background:#f8fafc;border-bottom:2px solid #e2e8f0;">
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">Code</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">Campaign</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">Discount</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">Usage</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">Window</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">New Only</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">Status</th>
                                    <th style="padding:.75rem 1rem;text-align:left;font-size:.8rem;color:#475569;font-weight:700;text-transform:uppercase;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="codesTableBody">
                                <tr><td colspan="8" style="text-align:center;color:#6b7280;padding:2rem;">Loading discount codes...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
             CREDITS TAB
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="credits" class="tab-content">
            <div class="card" style="margin-bottom:1.5rem;">
                <div class="card-header">
                    <h2 class="card-title">üí∞ Grant Credits</h2>
                    <p style="color:#64748b;margin-top:.5rem;font-size:.95rem;">Add account credits to a user's balance.</p>
                </div>
                <div class="card-body">
                    <div style="display:grid;grid-template-columns:1fr auto;gap:1rem;align-items:end;margin-bottom:1rem;">
                        <div>
                            <label style="font-weight:600;font-size:.85rem;color:#374151;display:block;margin-bottom:.4rem;">User Email</label>
                            <input type="email" id="creditUserEmail" class="form-input" placeholder="user@example.com">
                        </div>
                        <button onclick="lookupCreditUser()" class="btn btn-secondary">üîç Find User</button>
                    </div>
                    <div id="creditUserResult" style="margin-bottom:1rem;font-size:.9rem;min-height:1.5rem;"></div>
                    <div style="display:grid;grid-template-columns:150px 1fr auto;gap:1rem;align-items:end;">
                        <div>
                            <label style="font-weight:600;font-size:.85rem;color:#374151;display:block;margin-bottom:.4rem;">Amount ($)</label>
                            <input type="number" id="creditAmount" class="form-input" placeholder="25.00" step="0.01" min="0.01">
                        </div>
                        <div>
                            <label style="font-weight:600;font-size:.85rem;color:#374151;display:block;margin-bottom:.4rem;">Description</label>
                            <input type="text" id="creditDescription" class="form-input" placeholder="e.g. Referral bonus, promotional credit">
                        </div>
                        <button id="grantCreditsBtn" onclick="grantCredits()" class="btn btn-primary">Grant Credits ‚Üí</button>
                    </div>
                    <div id="grantCreditsFeedback" style="margin-top:.75rem;font-size:.9rem;"></div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">üìä Check User Balance</h2>
                    <p style="color:#64748b;margin-top:.5rem;font-size:.95rem;">Look up a user's credit balance and transaction history.</p>
                </div>
                <div class="card-body">
                    <div style="display:grid;grid-template-columns:1fr auto;gap:1rem;align-items:end;margin-bottom:1rem;">
                        <div>
                            <label style="font-weight:600;font-size:.85rem;color:#374151;display:block;margin-bottom:.4rem;">User Email</label>
                            <input type="email" id="balanceUserEmail" class="form-input" placeholder="user@example.com">
                        </div>
                        <button onclick="loadUserBalance()" class="btn btn-secondary">üìä Check Balance</button>
                    </div>
                    <div id="balanceDisplay" style="display:none;background:#f8fafc;border:1px solid #e2e8f0;border-radius:10px;padding:1.25rem;">
                        <div id="balanceUserInfo" style="margin-bottom:.75rem;"></div>
                        <div style="font-size:2rem;font-weight:700;color:#059669;margin-bottom:1rem;" id="balanceAmount">$0.00</div>
                        <h4 style="font-size:.85rem;color:#475569;font-weight:700;text-transform:uppercase;margin-bottom:.75rem;">Transaction History</h4>
                        <div id="transactionList" style="max-height:300px;overflow-y:auto;border:1px solid #e2e8f0;border-radius:8px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Waitlist Tab -->
        <div id="waitlist" class="tab-content">
            <div class="card">
                <div class="card-header" style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:1rem;">
                    <div>
                        <h2 class="card-title">üìã Waitlist Signups</h2>
                        <p style="color:#64748b;margin-top:.5rem;font-size:.95rem;">Everyone who signed up to be notified at launch.</p>
                    </div>
                    <div style="display:flex;gap:.75rem;align-items:center;">
                        <span id="waitlist-count" style="background:#e0f2fe;color:#0369a1;font-size:.85rem;font-weight:600;padding:.35rem .9rem;border-radius:20px;">Loading...</span>
                        <button onclick="exportWaitlistCSV()" style="padding:.5rem 1.1rem;background:#059669;color:#fff;border:none;border-radius:8px;font-size:.875rem;font-weight:600;cursor:pointer;">‚¨á Export CSV</button>
                        <button onclick="loadWaitlist()" style="padding:.5rem 1.1rem;background:#1a365d;color:#fff;border:none;border-radius:8px;font-size:.875rem;font-weight:600;cursor:pointer;">‚Üª Refresh</button>
                    </div>
                </div>
                <div class="card-body">
                    <!-- Search -->
                    <div style="margin-bottom:1.25rem;">
                        <input type="text" id="waitlist-search" placeholder="Search by name or email‚Ä¶" oninput="filterWaitlist()"
                            style="width:100%;padding:.75rem 1rem;border:2px solid #e2e8f0;border-radius:10px;font-size:.9rem;font-family:inherit;outline:none;box-sizing:border-box;"
                            onfocus="this.style.borderColor='#059669'" onblur="this.style.borderColor='#e2e8f0'">
                    </div>
                    <!-- Table -->
                    <div style="overflow-x:auto;">
                        <table class="table" id="waitlist-table">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Discipline</th>
                                    <th>Signed Up</th>
                                    <th>Source</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="waitlist-tbody">
                                <tr><td colspan="7" style="text-align:center;color:#94a3b8;padding:2rem;">Loading waitlist‚Ä¶</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         USER DETAIL MODAL
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="modal-overlay" id="userDetailModal">
        <div class="modal-box">
            <button class="modal-close" onclick="closeUserDetailModal()" title="Close">√ó</button>
            <div class="modal-title">üë§ User Details</div>

            <!-- Status message -->
            <div id="udm-status" class="success-message" style="display:none;"></div>

            <!-- Header info row -->
            <div class="modal-section" style="background:#f9fafb;border-radius:8px;padding:1rem;margin-bottom:1.5rem;">
                <h3 id="udm-name" style="color:#1e3a8a;margin:0 0 0.25rem 0;font-size:1.25rem;"></h3>
                <div id="udm-email" style="color:#6b7280;font-size:0.9rem;margin-bottom:0.5rem;"></div>
                <div style="display:flex;gap:0.5rem;flex-wrap:wrap;align-items:center;">
                    <span id="udm-role-badge" class="badge-user"></span>
                    <span id="udm-suspended-badge" class="badge-suspended" style="display:none;"></span>
                    <span style="color:#9ca3af;font-size:0.8rem;">Member since: <span id="udm-created"></span></span>
                </div>
            </div>

            <!-- Edit Profile Section -->
            <div class="modal-section">
                <h4>‚úèÔ∏è Edit Profile</h4>
                <div class="form-grid-2">
                    <div class="form-group">
                        <label class="form-label">First Name</label>
                        <input type="text" id="udm-first-name" class="form-input" placeholder="First name">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Last Name</label>
                        <input type="text" id="udm-last-name" class="form-input" placeholder="Last name">
                    </div>
                    <div class="form-group">
                        <label class="form-label">License Number</label>
                        <input type="text" id="udm-license" class="form-input" placeholder="TX12345">
                    </div>
                    <div class="form-group">
                        <label class="form-label">State</label>
                        <input type="text" id="udm-state" class="form-input" placeholder="TX" maxlength="2"
                            style="text-transform:uppercase;" oninput="this.value=this.value.toUpperCase()">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Profession</label>
                    <select id="udm-profession" class="form-select">
                        <option value="">Select profession...</option>
                        <option value="PT">Physical Therapist (PT)</option>
                        <option value="PTA">PT Assistant (PTA)</option>
                        <option value="OT">Occupational Therapist (OT)</option>
                        <option value="COTA">OT Assistant (COTA)</option>
                    </select>
                </div>
                <button class="btn btn-primary" onclick="saveUserProfile()">üíæ Save Profile Changes</button>
            </div>

            <!-- License Expiry -->
            <div class="modal-section">
                <h4>üéì License Expiry</h4>
                <div style="display:flex;gap:.75rem;align-items:flex-end;flex-wrap:wrap;">
                    <div class="form-group" style="margin:0;">
                        <label class="form-label" style="font-size:.85rem;">Expiry Date</label>
                        <input type="date" id="udm-license-expiry" class="form-input" style="width:200px;">
                    </div>
                    <button class="btn btn-primary" onclick="saveLicenseExpiry()" style="height:fit-content;">üíæ Save Expiry</button>
                </div>
            </div>

            <!-- Account Actions Section -->
            <div class="modal-section">
                <h4>‚öôÔ∏è Account Actions</h4>
                <div style="display:flex;gap:0.75rem;flex-wrap:wrap;">
                    <button id="udm-toggle-admin-btn" class="btn btn-primary" onclick="toggleAdmin()">üõ°Ô∏è Toggle Admin</button>
                    <button id="udm-suspend-btn" class="btn btn-warning" onclick="toggleSuspend()">‚ö†Ô∏è Suspend User</button>
                    <button class="btn btn-secondary" onclick="sendPasswordReset()">üîë Send Password Reset</button>
                    <button class="btn btn-danger" onclick="deleteUserAccount()">üóëÔ∏è Delete Account</button>
                </div>
            </div>

            <!-- Enrollments Section -->
            <div class="modal-section">
                <h4>üìö Enrollments</h4>
                <div id="udm-enrollments" style="margin-bottom:1.25rem;min-height:2rem;"></div>

                <div id="udm-enroll-section">
                    <h4 style="font-size:0.9rem;color:#374151;border:none;padding:0;margin-bottom:0.5rem;">Manually Enroll in Course</h4>
                    <div style="display:flex;gap:0.75rem;align-items:center;">
                        <select id="udm-course-select" class="form-select" style="flex:1;">
                            <option value="">Loading courses...</option>
                        </select>
                        <button class="btn btn-success" onclick="manualEnroll()" style="white-space:nowrap;">
                            ‚ûï Enroll
                        </button>
                    </div>
                </div>
            </div>

            <!-- Certificates Section -->
            <div class="modal-section">
                <h4>üèÜ Certificates</h4>
                <div id="udm-certificates" style="min-height:2rem;">
                    <p style="color:#6b7280;font-style:italic;">Loading certificates‚Ä¶</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         ADD USER MODAL
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="modal-overlay" id="addUserModal">
        <div class="modal-box">
            <button class="modal-close" onclick="closeAddUserModal()" title="Close">√ó</button>
            <div class="modal-title">üë§ Create New User Account</div>

            <div id="addUserError" class="error-message" style="display:none;"></div>
            <div id="addUserSuccess" class="success-message" style="display:none;"></div>

            <form id="addUserForm" onsubmit="event.preventDefault(); submitAddUser();">
                <div class="form-grid-2">
                    <div class="form-group">
                        <label class="form-label">First Name *</label>
                        <input type="text" id="au-first-name" class="form-input" placeholder="Sarah" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Last Name *</label>
                        <input type="text" id="au-last-name" class="form-input" placeholder="Johnson" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email Address *</label>
                        <input type="email" id="au-email" class="form-input" placeholder="sarah@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Temporary Password *</label>
                        <input type="password" id="au-password" class="form-input"
                            placeholder="Min. 8 characters" minlength="8" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Profession *</label>
                        <select id="au-profession" class="form-select" required>
                            <option value="">Select profession...</option>
                            <option value="PT">Physical Therapist (PT)</option>
                            <option value="PTA">PT Assistant (PTA)</option>
                            <option value="OT">Occupational Therapist (OT)</option>
                            <option value="COTA">OT Assistant (COTA)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">License Number</label>
                        <input type="text" id="au-license" class="form-input" placeholder="TX12345">
                    </div>
                    <div class="form-group">
                        <label class="form-label">State</label>
                        <input type="text" id="au-state" class="form-input" placeholder="TX" maxlength="2"
                            style="text-transform:uppercase;" oninput="this.value=this.value.toUpperCase()">
                    </div>
                </div>

                <div class="info-box" style="margin-top:1rem;font-size:0.85rem;">
                    The user will be created with a confirmed email and can log in immediately with the temporary password.
                </div>

                <div style="display:flex;gap:1rem;margin-top:1.5rem;">
                    <button type="submit" id="au-submit-btn" class="btn btn-primary">‚úÖ Create Account</button>
                    <button type="button" class="btn btn-secondary" onclick="closeAddUserModal()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin panel logic - external file -->
    <script src="js/admin.js?v=20260224d"></script>
</body>
</html><!-- deploy check Tue Feb 24 14:45:44 CST 2026 -->
